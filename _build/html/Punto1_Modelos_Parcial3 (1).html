
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelamiento del Conjunto de Datos: Satisfacción de Clientes &#8212; entregatres</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Punto1_Modelos_Parcial3 (1)';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ejercicios de Fisioterapia: EDA" href="segundo_punto.html" />
    <link rel="prev" title="Problema de clasificación" href="Punto1EDA_Parcial3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="entregatres - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="entregatres - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Parcial 3
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Punto1EDA_Parcial3.html">Problema de clasificación</a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">Modelamiento del Conjunto de Datos: Satisfacción de Clientes</a></li>

<li class="toctree-l1"><a class="reference internal" href="segundo_punto.html">Ejercicios de Fisioterapia: EDA</a></li>




<li class="toctree-l1"><a class="reference internal" href="definitivo.html">Ejercicio de Fisioterapia: Modelos</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FPunto1_Modelos_Parcial3 (1).html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Punto1_Modelos_Parcial3 (1).ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelamiento del Conjunto de Datos: Satisfacción de Clientes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Modelamiento del Conjunto de Datos: Satisfacción de Clientes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-de-modelos-de-clasificacion">1. Implementación de Modelos de Clasificación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cargue-e-instalacion-de-librerias">Cargue e instalación de librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cargue-de-datos">Cargue de datos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtrado-de-variables-a-modelar">Filtrado de variables a modelar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conjunto-de-entrenamiento">Conjunto de entrenamiento</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#conjunto-de-test">Conjunto de test</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-machine-learning">Modelos de Machine Learning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-la-variable-objetivo">Análisis exploratorio de la variable objetivo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combinacion-oversampling-de-la-clase-minoritaria-y-undersampling-de-la-clase-mayoritaria-smoteenn"><strong>Combinación Oversampling de la Clase Minoritaria y Undersampling de la clase mayoritaria (SMOTEENN)</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-clasificacion-bayesiana-con-balanceo-de-clases-smoteenn">Modelo de Clasificación Bayesiana con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-l1-l2-penalty-logistic-regression-con-balanceo-de-clases-smoteenn">Modelo L1/L2 Penalty Logistic Regression con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-clasificacion-k-nn-con-balanceo-de-clases-smoteenn">Modelo de clasificación K-NN con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-con-balanceo-de-clase-smoteenn">XGBoost con balanceo de clase SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-suport-vector-machine-svm-con-balanceo-de-clases-smoteenn">Modelo Suport Vector Machine (SVM) con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-random-forest-con-balanceo-de-clases-smoteenn">Modelo Random Forest con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-finales-para-cada-modelo">Mètricas finales para cada modelo</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelamiento-del-conjunto-de-datos-satisfaccion-de-clientes">
<h1>Modelamiento del Conjunto de Datos: Satisfacción de Clientes<a class="headerlink" href="#modelamiento-del-conjunto-de-datos-satisfaccion-de-clientes" title="Link to this heading">#</a></h1>
<section id="implementacion-de-modelos-de-clasificacion">
<h2>1. Implementación de Modelos de Clasificación<a class="headerlink" href="#implementacion-de-modelos-de-clasificacion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Utilizar la versión de clasificación para cada modelo estudiado en clases.</p></li>
<li><p>Predecir la <strong>variable respuesta</strong> (última columna) y calcular las probabilidades para la <strong>variable target</strong>.</p></li>
<li><p>Generar una <strong>tabla de error</strong> que contenga las siguientes métricas de clasificación:</p>
<ul>
<li><p>Precision</p></li>
<li><p>Recall</p></li>
<li><p>F1-Score</p></li>
<li><p>AUC</p></li>
</ul>
</li>
<li><p>Agregar los siguientes elementos:</p>
<ul>
<li><p><strong>Matriz de Confusión</strong>: Utilizar <code class="docutils literal notranslate"><span class="pre">confusion_matrix</span></code>.</p></li>
<li><p><strong>Curvas ROC</strong>: Utilizar <code class="docutils literal notranslate"><span class="pre">plot_roc</span></code>.</p></li>
</ul>
</li>
<li><p>Registrar los resultados en una <strong>tabla de error</strong> (similar a Tabla 1) que resuma cada métrica obtenida por modelo.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="cargue-e-instalacion-de-librerias">
<h2>Cargue e instalación de librerías<a class="headerlink" href="#cargue-e-instalacion-de-librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">neurosynth</span><span class="o">/</span><span class="n">ACE</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting git+https://github.com/neurosynth/ACE.git
  Cloning https://github.com/neurosynth/ACE.git to /tmp/pip-req-build-6jnzqj1a
  Running command git clone --filter=blob:none --quiet https://github.com/neurosynth/ACE.git /tmp/pip-req-build-6jnzqj1a
  Resolved https://github.com/neurosynth/ACE.git to commit ebcf4fc1d0ab5cea5b0b622e9b7c8271388b6295
  Preparing metadata (setup.py) ... ?25l?25hdone
Building wheels for collected packages: ace
  Building wheel for ace (setup.py) ... ?25l?25hdone
  Created wheel for ace: filename=ace-0.1.0.dev0-py3-none-any.whl size=644520 sha256=02edf07d434e75c2b761ed4adf1f9d761f4db31ea11ae668197ddb6a42db21dd
  Stored in directory: /tmp/pip-ephem-wheel-cache-4lxi37nu/wheels/97/ff/c8/83cdb258a78a2907b7785fb855667bd567ebc441201529da20
Successfully built ace
Installing collected packages: ace
Successfully installed ace-0.1.0.dev0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas</span> <span class="n">numpy</span> <span class="n">matplotlib</span> <span class="n">seaborn</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span> <span class="n">scipy</span> <span class="n">tabulate</span> <span class="n">plotly</span> <span class="n">statsmodels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (2.2.2)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (1.26.4)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (3.8.0)
Requirement already satisfied: seaborn in /usr/local/lib/python3.10/dist-packages (0.13.2)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (1.5.2)
Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (1.13.1)
Collecting tabulate
  Downloading tabulate-0.9.0-py3-none-any.whl.metadata (34 kB)
Requirement already satisfied: plotly in /usr/local/lib/python3.10/dist-packages (5.24.1)
Collecting statsmodels
  Downloading statsmodels-0.14.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (9.2 kB)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas) (2024.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas) (2024.2)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (4.54.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.4.7)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (24.2)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (11.0.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (3.2.0)
Requirement already satisfied: joblib&gt;=1.2.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.4.2)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (3.5.0)
Requirement already satisfied: tenacity&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly) (9.0.0)
Collecting patsy&gt;=0.5.6 (from statsmodels)
  Downloading patsy-1.0.1-py2.py3-none-any.whl.metadata (3.3 kB)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.16.0)
Downloading tabulate-0.9.0-py3-none-any.whl (35 kB)
Downloading statsmodels-0.14.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (10.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">10.8/10.8 MB</span> <span class=" -Color -Color-Red">97.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading patsy-1.0.1-py2.py3-none-any.whl (232 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">232.9/232.9 kB</span> <span class=" -Color -Color-Red">17.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: tabulate, patsy, statsmodels
Successfully installed patsy-1.0.1 statsmodels-0.14.4 tabulate-0.9.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">imbalanced</span><span class="o">-</span><span class="n">learn</span> <span class="n">tqdm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting imbalanced-learn
  Downloading imbalanced_learn-0.12.4-py3-none-any.whl.metadata (8.3 kB)
Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (4.66.6)
Requirement already satisfied: numpy&gt;=1.17.3 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (1.26.4)
Requirement already satisfied: scipy&gt;=1.5.0 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (1.13.1)
Requirement already satisfied: scikit-learn&gt;=1.0.2 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (1.5.2)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (1.4.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (3.5.0)
Downloading imbalanced_learn-0.12.4-py3-none-any.whl (258 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">258.3/258.3 kB</span> <span class=" -Color -Color-Red">4.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: imbalanced-learn
Successfully installed imbalanced-learn-0.12.4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pqdm</span> <span class="n">xgboost</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pqdm
  Downloading pqdm-0.2.0-py2.py3-none-any.whl.metadata (3.2 kB)
Collecting xgboost
  Downloading xgboost-2.1.2-py3-none-manylinux_2_28_x86_64.whl.metadata (2.1 kB)
Collecting bounded-pool-executor (from pqdm)
  Downloading bounded_pool_executor-0.0.3-py3-none-any.whl.metadata (2.7 kB)
Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from pqdm) (4.66.6)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from pqdm) (4.12.2)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from xgboost) (1.26.4)
Collecting nvidia-nccl-cu12 (from xgboost)
  Downloading nvidia_nccl_cu12-2.23.4-py3-none-manylinux2014_x86_64.whl.metadata (1.8 kB)
Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from xgboost) (1.13.1)
Downloading pqdm-0.2.0-py2.py3-none-any.whl (6.8 kB)
Downloading xgboost-2.1.2-py3-none-manylinux_2_28_x86_64.whl (153.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">153.9/153.9 MB</span> <span class=" -Color -Color-Red">6.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading bounded_pool_executor-0.0.3-py3-none-any.whl (3.4 kB)
Downloading nvidia_nccl_cu12-2.23.4-py3-none-manylinux2014_x86_64.whl (199.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">199.0/199.0 MB</span> <span class=" -Color -Color-Red">5.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: bounded-pool-executor, pqdm, nvidia-nccl-cu12, xgboost
Successfully installed bounded-pool-executor-0.0.3 nvidia-nccl-cu12-2.23.4 pqdm-0.2.0 xgboost-2.1.2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>  <span class="c1"># Import the drive module from google.colab</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">kurtosis</span><span class="p">,</span> <span class="n">skew</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">import</span> <span class="nn">plotly.subplots</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="kn">import</span> <span class="n">Histogram</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">ParameterGrid</span><span class="p">,</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span><span class="p">,</span> <span class="n">KNNImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="c1"># Instead of importing plot_roc_curve, import RocCurveDisplay</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">RocCurveDisplay</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span> <span class="nn">imblearn.under_sampling</span> <span class="kn">import</span> <span class="n">RandomUnderSampler</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">pqdm.threads</span> <span class="kn">import</span> <span class="n">pqdm</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">imblearn.combine</span> <span class="kn">import</span> <span class="n">SMOTEENN</span>
<span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">imblearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span> <span class="k">as</span> <span class="n">ImbPipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">ConfusionMatrixDisplay</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
</section>
<section id="cargue-de-datos">
<h2>Cargue de datos<a class="headerlink" href="#cargue-de-datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filepath</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/content/drive/My Drive/Parcial3/train.csv&#39;</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/content/drive/My Drive/Parcial3/test.csv&#39;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="filtrado-de-variables-a-modelar">
<h3>Filtrado de variables a modelar<a class="headerlink" href="#filtrado-de-variables-a-modelar" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;imp_ent_var16_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var40_comer_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var40_comer_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var40_efect_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var40_efect_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var40_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var41_comer_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var41_comer_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var39_efect_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var39_efect_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_sal_var16_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var5&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var8&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var13_largo&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var14&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var25&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var29&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var33&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var37&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var40&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_var44&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_imp_aport_var13_1y3&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_imp_aport_var17_1y3&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_imp_aport_var33_1y3&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_imp_compra_var44_1y3&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_imp_venta_var44_1y3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_amort_var18_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_amort_var34_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_aport_var13_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_aport_var13_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_aport_var17_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_var7_emit_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_var7_recib_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_compra_var44_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_reemb_var13_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_reemb_var17_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_reemb_var17_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_var43_emit_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_trans_var37_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_trasp_var17_in_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_trasp_var17_in_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_trasp_var17_out_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_trasp_var33_in_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_trasp_var33_in_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_venta_var44_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_venta_var44_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var5_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var5_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var5_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var5_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var8_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var8_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var8_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var12_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var12_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var13_corto_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var13_corto_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var13_largo_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var13_largo_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var13_largo_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var13_medio_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var17_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var29_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var29_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var29_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var33_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var33_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var44_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var44_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;var38&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var35&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var41_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var13_corto&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var41_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var31&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var43_recib_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var22_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_reemb_var17_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var26&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var24_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var41_efect_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var8&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var25_cte&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var8_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var20&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var26_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var39_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var39_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var17_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var14_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var30_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var40&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var13_corto_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_meses_var13_largo_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var5&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var39&#39;</span><span class="p">,</span> <span class="s1">&#39;num_meses_var12_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var25_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var8&#39;</span><span class="p">,</span> <span class="s1">&#39;num_meses_var8_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var45_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var39_efect_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var26_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var25_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var26_cte&#39;</span><span class="p">,</span> <span class="s1">&#39;num_aport_var13_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var25&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var13_largo&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var24_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var4&#39;</span><span class="p">,</span> <span class="s1">&#39;num_meses_var39_vig_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var22_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;var21&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var30&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var41_comer_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var12_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var24&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var5&#39;</span><span class="p">,</span> <span class="s1">&#39;var15&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var39_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var8_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var39_efect_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var13_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var13_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var45_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var42_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var30&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var31&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var9_cte_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var25&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var13_largo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var20_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var12_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var9_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_med_var45_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var31_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var45_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var20_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var10cte_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var13_largo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var39&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var1_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var39_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var40_efect_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var13&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var45_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var40_efect_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var12&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var40_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var41_efect_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var5_0&#39;</span><span class="p">,</span> <span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var22_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var41_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var40&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var31_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var30_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var13_corto&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var19&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var22_hace3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_meses_var5_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var13_corto_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var42&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var13&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var41_0&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var13_largo&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var14_0&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var26&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var10_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_meses_var13_corto_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var12&#39;</span><span class="p">,</span> <span class="s1">&#39;var36&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var20&#39;</span><span class="p">,</span> <span class="s1">&#39;num_med_var22_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var24&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var43_emit_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_aport_var17_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;num_var37_med_ult2&#39;</span><span class="p">,</span> <span class="s1">&#39;num_op_var39_comer_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;ind_var5_0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="conjunto-de-entrenamiento">
<h3>Conjunto de entrenamiento<a class="headerlink" href="#conjunto-de-entrenamiento" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span>  <span class="c1"># Conjunto de entrenamiento (contiene &#39;TARGET&#39;)</span>
<span class="c1"># Contar las variables de tipo numérico (flotante) y categórico (objeto)</span>
<span class="n">numeric_vars</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">categorical_vars</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Mostrar el número de variables de cada tipo</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de variables numéricas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">numeric_vars</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de variables categóricas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">categorical_vars</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de variables numéricas: 182
Número de variables categóricas: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">type_counts</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">type_counts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variable Types and Counts:&quot;</span><span class="p">)</span>
<span class="n">type_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable Types and Counts:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-436b7527-429a-44b9-9209-c1bda240cb6e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>int64</td>
      <td>112</td>
    </tr>
    <tr>
      <th>1</th>
      <td>float64</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-436b7527-429a-44b9-9209-c1bda240cb6e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-436b7527-429a-44b9-9209-c1bda240cb6e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-436b7527-429a-44b9-9209-c1bda240cb6e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-75e8607c-cbf9-41f3-8928-f6e8a8bb1614">
  <button class="colab-df-quickchart" onclick="quickchart('df-75e8607c-cbf9-41f3-8928-f6e8a8bb1614')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-75e8607c-cbf9-41f3-8928-f6e8a8bb1614 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_5d96b7bc-73e2-4556-b9c2-564bacf9db96">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('type_counts')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_5d96b7bc-73e2-4556-b9c2-564bacf9db96 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('type_counts');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<section id="conjunto-de-test">
<h4>Conjunto de test<a class="headerlink" href="#conjunto-de-test" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrar las columnas necesarias (asegúrate de que &#39;variables&#39; esté definida)</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span>  <span class="c1"># &#39;variables&#39; debe incluir todas las columnas relevantes, incluyendo &#39;TARGET&#39;</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">test</span><span class="p">[[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span> <span class="k">if</span> <span class="n">var</span> <span class="o">!=</span> <span class="s1">&#39;TARGET&#39;</span><span class="p">]]</span>  <span class="c1"># Excluye &#39;TARGET&#39; en test</span>

<span class="c1"># Excluir &#39;TARGET&#39; de las columnas int64 y float64</span>
<span class="n">train_int_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">train_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">var</span> <span class="o">!=</span> <span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>
<span class="n">train_float_vars</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Aplicar las mismas categorías al conjunto de prueba</span>
<span class="n">test_data_corrected</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Transformar las columnas en test_data_corrected para que coincidan con train</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_int_vars</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Verificar si hay columnas int64</span>
    <span class="n">test_data_corrected</span><span class="p">[</span><span class="n">train_int_vars</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data_corrected</span><span class="p">[</span><span class="n">train_int_vars</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">train_float_vars</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>  <span class="c1"># Verificar si hay columnas float64</span>
    <span class="n">test_data_corrected</span><span class="p">[</span><span class="n">train_float_vars</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data_corrected</span><span class="p">[</span><span class="n">train_float_vars</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Recalcular los tipos para verificar la corrección</span>
<span class="n">type_counts_test_corrected</span> <span class="o">=</span> <span class="n">test_data_corrected</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">type_counts_test_corrected</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variable Types and Counts (Corregido):&quot;</span><span class="p">)</span>
<span class="n">type_counts_test_corrected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable Types and Counts (Corregido):
</pre></div>
</div>
<div class="output text_html">
  <div id="df-2370d3f5-c7a8-427c-beb0-23bb8b151901" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>int64</td>
      <td>111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>float64</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2370d3f5-c7a8-427c-beb0-23bb8b151901')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2370d3f5-c7a8-427c-beb0-23bb8b151901 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2370d3f5-c7a8-427c-beb0-23bb8b151901');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-15b3a1ac-c0c6-41c6-9ccf-5a4f78977383">
  <button class="colab-df-quickchart" onclick="quickchart('df-15b3a1ac-c0c6-41c6-9ccf-5a4f78977383')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-15b3a1ac-c0c6-41c6-9ccf-5a4f78977383 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_b8676f90-0363-4c11-8ba1-0e8b275854d1">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('type_counts_test_corrected')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_b8676f90-0363-4c11-8ba1-0e8b275854d1 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('type_counts_test_corrected');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos-de-machine-learning">
<h1>Modelos de Machine Learning<a class="headerlink" href="#modelos-de-machine-learning" title="Link to this heading">#</a></h1>
<section id="analisis-exploratorio-de-la-variable-objetivo">
<h2>Análisis exploratorio de la variable objetivo<a class="headerlink" href="#analisis-exploratorio-de-la-variable-objetivo" title="Link to this heading">#</a></h2>
<p>Se observa que la variable <code class="docutils literal notranslate"><span class="pre">TARGET</span></code> es binaria, es decir, tiene dos posibles valores: <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">y</span> <span class="pre">1</span></code>.</p>
<ul class="simple">
<li><p>El conteo para el valor <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">es</span> <span class="pre">73,012</span> <span class="pre">casos</span></code>, representando la mayoría de los datos.</p></li>
<li><p>El conteo para el <code class="docutils literal notranslate"><span class="pre">valor</span> <span class="pre">1</span> <span class="pre">es</span> <span class="pre">3,008</span></code> casos, lo cual corresponde a una minoría.</p></li>
</ul>
<p>Esto indica un desequilibrio en la distribución de la variable objetivo, lo cual es típico en problemas de clasificación desbalanceada como el análisis de riesgo crediticio o detección de fraudes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Contar las categorías en la variable TARGET para el gráfico de barras</span>
<span class="n">target_counts</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">target_counts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">]</span>

<span class="c1"># Crear gráfico de barras</span>
<span class="n">bar_chart</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">target_counts</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">target_counts</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">],</span>
    <span class="n">text</span><span class="o">=</span><span class="n">target_counts</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">],</span>
    <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Distribución de TARGET&#39;</span>
<span class="p">)</span>

<span class="c1"># Crear el gráfico de pastel para la proporción</span>
<span class="n">target_proportions</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">target_proportions</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;Proportion&#39;</span><span class="p">]</span>

<span class="n">pie_chart</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Pie</span><span class="p">(</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">target_proportions</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="n">target_proportions</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">],</span>
    <span class="n">hole</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">textinfo</span><span class="o">=</span><span class="s1">&#39;percent+label&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Proporción de TARGET&#39;</span>
<span class="p">)</span>

<span class="c1"># Crear un subplots para mostrar ambos gráficos juntos</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Distribución de la Variable TARGET&quot;</span><span class="p">,</span> <span class="s2">&quot;Proporción de TARGET&quot;</span><span class="p">),</span>
                       <span class="n">specs</span><span class="o">=</span><span class="p">[[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;pie&quot;</span><span class="p">}]])</span>

<span class="c1"># Agregar el gráfico de barras a la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">bar_chart</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Agregar el gráfico de pastel a la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">pie_chart</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Actualizar el layout</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Distribución y Proporción de la Variable TARGET&quot;</span><span class="p">,</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Mostrar la figura</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="89837946-9982-44fd-a7e7-980f5707c2c2" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("89837946-9982-44fd-a7e7-980f5707c2c2")) {                    Plotly.newPlot(                        "89837946-9982-44fd-a7e7-980f5707c2c2",                        [{"name":"Distribución de TARGET","text":[73012.0,3008.0],"textposition":"auto","x":[0,1],"y":[73012,3008],"type":"bar","xaxis":"x","yaxis":"y"},{"hole":0.4,"labels":[0,1],"name":"Proporción de TARGET","textinfo":"percent+label","values":[0.9604314654038411,0.0395685345961589],"type":"pie","domain":{"x":[0.55,1.0],"y":[0.0,1.0]}}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45]},"yaxis":{"anchor":"x","domain":[0.0,1.0]},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Distribución de la Variable TARGET","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Proporción de TARGET","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"title":{"text":"Distribución y Proporción de la Variable TARGET"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('89837946-9982-44fd-a7e7-980f5707c2c2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<p><strong>Evaluar Ratio de desbalanceo entre clases</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">target_proportions</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">imbalance_ratio</span> <span class="o">=</span> <span class="n">target_proportions</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="n">target_proportions</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ratio de Desbalanceo: </span><span class="si">{</span><span class="n">imbalance_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ratio de Desbalanceo: 24.27
</pre></div>
</div>
</div>
</div>
<section id="combinacion-oversampling-de-la-clase-minoritaria-y-undersampling-de-la-clase-mayoritaria-smoteenn">
<h3><strong>Combinación Oversampling de la Clase Minoritaria y Undersampling de la clase mayoritaria (SMOTEENN)</strong><a class="headerlink" href="#combinacion-oversampling-de-la-clase-minoritaria-y-undersampling-de-la-clase-mayoritaria-smoteenn" title="Link to this heading">#</a></h3>
<p>Se implementará una combinación entre submuestro de clase mayoritaria y sobremuestro de clase minoritaria para balanceo de clases mediante generación sintética y disminución medida de etiquetas con método SMOTEENN.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># División de los datos en características y variable objetivo</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Conjunto de características sin la columna TARGET</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>  <span class="c1"># Variable objetivo (TARGET)</span>

<span class="c1"># Aplicar SMOTEENN para balancear los datos</span>
<span class="n">smote_enn</span> <span class="o">=</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">smote_enn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SMOTE</span> <span class="pre">(Synthetic</span> <span class="pre">Minority</span> <span class="pre">Oversampling</span> <span class="pre">Technique):</span></code> Genera datos sintéticos para la clase minoritaria (1) para reducir el desbalance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ENN</span> <span class="pre">(Edited</span> <span class="pre">Nearest</span> <span class="pre">Neighbors):</span></code> Filtra ruido y elimina datos redundantes, mejorando la calidad del conjunto de datos.</p></li>
</ul>
<p><strong>Después del balanceo:</strong></p>
<p>Clase 1: Tiene 57,682 observaciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">balanced_counts</span> <span class="o">=</span> <span class="n">y_resampled</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># Crear gráfico de barras interactivo</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">balanced_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">balanced_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="n">balanced_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>
    <span class="p">)</span>
<span class="p">])</span>

<span class="c1"># Configuración del layout del gráfico</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Distribución de la Variable TARGET después del Balanceo (SMOTEENN)&quot;</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Categoría de TARGET&quot;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Cantidad de Observaciones&quot;</span><span class="p">,</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">),</span>
    <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_white&#39;</span>
<span class="p">)</span>

<span class="c1"># Mostrar la gráfica interactiva</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="28729407-18f7-4aba-9153-8c26dd3bd91f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("28729407-18f7-4aba-9153-8c26dd3bd91f")) {                    Plotly.newPlot(                        "28729407-18f7-4aba-9153-8c26dd3bd91f",                        [{"marker":{"color":"skyblue"},"text":[57682.0,53072.0],"textposition":"auto","x":["1","0"],"y":[57682,53072],"type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"title":{"text":"Categoría de TARGET"},"type":"category"},"title":{"text":"Distribución de la Variable TARGET después del Balanceo (SMOTEENN)"},"yaxis":{"title":{"text":"Cantidad de Observaciones"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('28729407-18f7-4aba-9153-8c26dd3bd91f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<p><strong>Conjunto de datos a utilizar</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X_resampled</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y_resampled</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_resampled</span><span class="p">))</span>

<span class="n">X_resampled_copy</span> <span class="o">=</span> <span class="n">X_resampled</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_resampled_copy</span> <span class="o">=</span> <span class="n">y_resampled</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
&lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_resampled_copy</span> <span class="o">=</span> <span class="n">X_resampled</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_resampled_copy</span> <span class="o">=</span> <span class="n">y_resampled</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modelo-de-clasificacion-bayesiana-con-balanceo-de-clases-smoteenn">
<h2>Modelo de Clasificación Bayesiana con balanceo de clases SMOTEENN<a class="headerlink" href="#modelo-de-clasificacion-bayesiana-con-balanceo-de-clases-smoteenn" title="Link to this heading">#</a></h2>
<p>Para el modelo de clasificación Bayesiana se hace la división de los datos y el balanceo previo al entrenamiento del modleo para evitar fuga de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>

<span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Dividir el conjunto de entrenamiento en entrenamiento y validación</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar SMOTEENN solo al conjunto de entrenamiento</span>
<span class="n">smoteenn</span> <span class="o">=</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled_bayesian</span><span class="p">,</span> <span class="n">y_resampled_bayesian</span> <span class="o">=</span> <span class="n">smoteenn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Lista de valores de var_smoothing a evaluar</span>
<span class="n">var_smoothing_settings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Ejemplo: [1e-09, 1e-08, ..., 1e-05]</span>

<span class="c1"># Crear una lista para almacenar las métricas</span>
<span class="n">metrics_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Variables para rastrear el mejor modelo</span>
<span class="n">best_val_accuracy</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
<span class="n">best_model_bayesian</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_var_smoothing</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;onehot&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Combinar los transformadores en un preprocesador</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">numerical_transformer</span><span class="p">,</span> <span class="n">numerical_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Iterar sobre los diferentes valores de var_smoothing con tqdm para mostrar el progreso</span>
<span class="k">for</span> <span class="n">var_smoothing</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">var_smoothing_settings</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Evaluando Clasificador Bayesiano&quot;</span><span class="p">):</span>
    <span class="c1"># Crear el pipeline con preprocesamiento y Naive Bayes</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;bayesian&#39;</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">(</span><span class="n">var_smoothing</span><span class="o">=</span><span class="n">var_smoothing</span><span class="p">))</span>
    <span class="p">])</span>

    <span class="c1"># Entrenar el modelo con el conjunto resampleado</span>
    <span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled_bayesian</span><span class="p">,</span> <span class="n">y_resampled_bayesian</span><span class="p">)</span>

    <span class="c1"># Predecir en el conjunto de entrenamiento original</span>
    <span class="n">y_train_pred_bayesian</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_train_proba_bayesian</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calcular métricas para el conjunto de entrenamiento</span>
    <span class="n">train_precision_bayesian</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred_bayesian</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">train_recall_bayesian</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred_bayesian</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">train_accuracy_bayesian</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred_bayesian</span><span class="p">)</span>
    <span class="n">train_f1_bayesian</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred_bayesian</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">train_auc_bayesian</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_proba_bayesian</span><span class="p">)</span>

    <span class="c1"># Predecir en el conjunto de validación</span>
    <span class="n">y_val_pred_bayesian</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">y_val_proba_bayesian</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calcular métricas para el conjunto de validación</span>
    <span class="n">val_precision_bayesian</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_bayesian</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">val_recall_bayesian</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_bayesian</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">val_accuracy_bayesian</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_bayesian</span><span class="p">)</span>
    <span class="n">val_f1_bayesian</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_bayesian</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">val_auc_bayesian</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_proba_bayesian</span><span class="p">)</span>

    <span class="c1"># Añadir las métricas a la lista</span>
    <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Bayesiano&#39;</span><span class="p">,</span>
        <span class="s1">&#39;var_smoothing&#39;</span><span class="p">:</span> <span class="n">var_smoothing</span><span class="p">,</span>
        <span class="s1">&#39;Train_Precision&#39;</span><span class="p">:</span> <span class="n">train_precision_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Train_Recall&#39;</span><span class="p">:</span> <span class="n">train_recall_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Train_Accuracy&#39;</span><span class="p">:</span> <span class="n">train_accuracy_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Train_F1&#39;</span><span class="p">:</span> <span class="n">train_f1_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Train_AUC&#39;</span><span class="p">:</span> <span class="n">train_auc_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Val_Precision&#39;</span><span class="p">:</span> <span class="n">val_precision_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Val_Recall&#39;</span><span class="p">:</span> <span class="n">val_recall_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Val_Accuracy&#39;</span><span class="p">:</span> <span class="n">val_accuracy_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Val_F1&#39;</span><span class="p">:</span> <span class="n">val_f1_bayesian</span><span class="p">,</span>
        <span class="s1">&#39;Val_AUC&#39;</span><span class="p">:</span> <span class="n">val_auc_bayesian</span>
    <span class="p">})</span>

    <span class="c1"># Verificar si este modelo es el mejor hasta ahora</span>
    <span class="k">if</span> <span class="n">val_accuracy_bayesian</span> <span class="o">&gt;</span> <span class="n">best_val_accuracy</span><span class="p">:</span>
        <span class="n">best_val_accuracy</span> <span class="o">=</span> <span class="n">val_accuracy_bayesian</span>
        <span class="n">best_model_bayesian</span> <span class="o">=</span> <span class="n">pipeline</span>
        <span class="n">best_var_smoothing</span> <span class="o">=</span> <span class="n">var_smoothing</span>

    <span class="c1"># Imprimir el progreso similar al ejemplo proporcionado</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;var_smoothing: </span><span class="si">{</span><span class="n">var_smoothing</span><span class="si">}</span><span class="s2">, Training Accuracy: </span><span class="si">{</span><span class="n">train_accuracy_bayesian</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Validación Accuracy: </span><span class="si">{</span><span class="n">val_accuracy_bayesian</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Convertir la lista de métricas a un DataFrame</span>
<span class="n">metrics_df_bayesian</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando Clasificador Bayesiano:  20%|██        | 1/5 [00:01&lt;00:07,  1.96s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>var_smoothing: 1e-09, Training Accuracy: 0.1471, Validación Accuracy: 0.1455
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando Clasificador Bayesiano:  40%|████      | 2/5 [00:03&lt;00:05,  1.77s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>var_smoothing: 1e-08, Training Accuracy: 0.1476, Validación Accuracy: 0.1461
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando Clasificador Bayesiano:  60%|██████    | 3/5 [00:05&lt;00:03,  1.71s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>var_smoothing: 1e-07, Training Accuracy: 0.1485, Validación Accuracy: 0.1471
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando Clasificador Bayesiano:  80%|████████  | 4/5 [00:06&lt;00:01,  1.69s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>var_smoothing: 1e-06, Training Accuracy: 0.1513, Validación Accuracy: 0.1499
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando Clasificador Bayesiano: 100%|██████████| 5/5 [00:08&lt;00:00,  1.74s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>var_smoothing: 1e-05, Training Accuracy: 0.1523, Validación Accuracy: 0.1506
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">var_smoothing</span></code>: Representa el parámetro de suavizado, que controla la estabilidad de las estimaciones de probabilidad.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Precisión</span></code>: Indica la precisión alcanzada en los conjuntos de entrenamiento y validación.</p></li>
</ol>
<p>El modelo mejora su rendimiento tanto en entrenamiento como en validación a medida que se incrementa <code class="docutils literal notranslate"><span class="pre">var_smoothing</span></code>, aunque persiste una ligera brecha entre ambas precisiones, indicando potencial sobreajuste moderado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar las precisiones de entrenamiento y validación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metrics_df_bayesian</span><span class="p">[</span><span class="s1">&#39;var_smoothing&#39;</span><span class="p">],</span> <span class="n">metrics_df_bayesian</span><span class="p">[</span><span class="s1">&#39;Train_Accuracy&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Precisión de Entrenamiento&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metrics_df_bayesian</span><span class="p">[</span><span class="s1">&#39;var_smoothing&#39;</span><span class="p">],</span> <span class="n">metrics_df_bayesian</span><span class="p">[</span><span class="s1">&#39;Val_Accuracy&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Precisión de Validación&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>  <span class="c1"># Escala logarítmica para var_smoothing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;var_smoothing&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precisión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Precisión de Clasificador Bayesiano según var_smoothing&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e7f22655e56a6ec190dbadc7b56ec959ee918398f7e1cf6a5ea5e85d5d468ae3.png" src="_images/e7f22655e56a6ec190dbadc7b56ec959ee918398f7e1cf6a5ea5e85d5d468ae3.png" />
</div>
</div>
<p><strong>AUC (Área Bajo la Curva)</strong></p>
<p>Ambos valores indican un desempeño cercano al azar (AUC ≈ 0.5), lo que sugiere que el modelo tiene poca capacidad para distinguir entre las clases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generar curvas ROC para el mejor modelo</span>
<span class="n">y_train_proba_best_bayesian</span> <span class="o">=</span> <span class="n">best_model_bayesian</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_val_proba_best_bayesian</span> <span class="o">=</span> <span class="n">best_model_bayesian</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">fpr_train_bayesian</span><span class="p">,</span> <span class="n">tpr_train_bayesian</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_proba_best_bayesian</span><span class="p">)</span>
<span class="n">fpr_val_bayesian</span><span class="p">,</span> <span class="n">tpr_val_bayesian</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_proba_best_bayesian</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_train_bayesian</span><span class="p">,</span> <span class="n">tpr_train_bayesian</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC Entrenamiento (AUC = </span><span class="si">{</span><span class="n">metrics_df_bayesian</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metrics_df_bayesian</span><span class="p">[</span><span class="s2">&quot;var_smoothing&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">best_var_smoothing</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Train_AUC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_val_bayesian</span><span class="p">,</span> <span class="n">tpr_val_bayesian</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC Validación (AUC = </span><span class="si">{</span><span class="n">metrics_df_bayesian</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metrics_df_bayesian</span><span class="p">[</span><span class="s2">&quot;var_smoothing&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">best_var_smoothing</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Val_AUC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>  <span class="c1"># Línea de referencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Curvas ROC para el Mejor Modelo Bayesiano (var_smoothing = </span><span class="si">{</span><span class="n">best_var_smoothing</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5422bee721eb1805cb62d1a3bdb5a44fd98df6dd1aafbcb563898af3e697d2c.png" src="_images/f5422bee721eb1805cb62d1a3bdb5a44fd98df6dd1aafbcb563898af3e697d2c.png" />
</div>
</div>
<p><strong>Matriz de confusión</strong></p>
<ul class="simple">
<li><p>Verdaderos Negativos (TN): 6,947 (clase 0 correctamente predicha como 0).</p></li>
<li><p>Falsos Positivos (FP): 51,463 (clase 0 incorrectamente predicha como 1).</p></li>
<li><p>Falsos Negativos (FN): 90 (clase 1 incorrectamente predicha como 0).</p></li>
<li><p>Verdaderos Positivos (TP): 2,316 (clase 1 correctamente predicha como 1).</p></li>
</ul>
<p>Esto indica que el modelo tiene una pobre especificidad, es decir, no distingue bien entre las clases, especialmente la clase mayoritaria.</p>
<p>La precisión es muy baja, ya que la mayoría de las predicciones positivas son incorrectas. Esto implica que el modelo no es confiable para clasificar correctamente instancias de la clase 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cm_train_bayesian</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">best_model_bayesian</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">disp_train_bayesian</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="o">=</span><span class="n">cm_train_bayesian</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="n">best_model_bayesian</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
<span class="n">disp_train_bayesian</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matriz de Confusión - Entrenamiento (var_smoothing = </span><span class="si">{</span><span class="n">best_var_smoothing</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c13e3839c7f198c6e173e4b4331eb94048a4806a36372ad3c6229f4ec81f483d.png" src="_images/c13e3839c7f198c6e173e4b4331eb94048a4806a36372ad3c6229f4ec81f483d.png" />
</div>
</div>
<ul class="simple">
<li><p>Verdaderos Negativos (TN): 1,709 (clase 0 correctamente predicha como 0).</p></li>
<li><p>Falsos Positivos (FP): 12,893 (clase 0 incorrectamente predicha como 1).</p></li>
<li><p>Falsos Negativos (FN): 21 (clase 1 incorrectamente predicha como 0).</p></li>
<li><p>Verdaderos Positivos (TP): 581 (clase 1 correctamente predicha como 1).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para el conjunto de validación</span>
<span class="n">cm_val_bayesian</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">best_model_bayesian</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">))</span>
<span class="n">disp_val_bayesian</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="o">=</span><span class="n">cm_val_bayesian</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="n">best_model_bayesian</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
<span class="n">disp_val_bayesian</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matriz de Confusión - Validación (var_smoothing = </span><span class="si">{</span><span class="n">best_var_smoothing</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cbc1c9b0fa1d33ec9049192b6dcb74cc34c8325447f94bcd1eba080a8d803354.png" src="_images/cbc1c9b0fa1d33ec9049192b6dcb74cc34c8325447f94bcd1eba080a8d803354.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar el DataFrame con las métricas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Métricas de Evaluación para cada configuración de Clasificador Bayesiano:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">metrics_df_bayesian</span><span class="p">)</span>

<span class="c1"># Mostrar el mejor modelo encontrado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejor var_smoothing: </span><span class="si">{</span><span class="n">best_var_smoothing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precisión de Validación: </span><span class="si">{</span><span class="n">best_val_accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Guardar el mejor modelo entrenado con joblib</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">best_model_bayesian</span><span class="p">,</span> <span class="s1">&#39;best_bayesian_model.joblib&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">El mejor modelo ha sido guardado como &#39;best_bayesian_model.joblib&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Métricas de Evaluación para cada configuración de Clasificador Bayesiano:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-d70beb31-c0f7-47aa-b4ba-7b3f5ae4ff2d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>var_smoothing</th>
      <th>Train_Precision</th>
      <th>Train_Recall</th>
      <th>Train_Accuracy</th>
      <th>Train_F1</th>
      <th>Train_AUC</th>
      <th>Val_Precision</th>
      <th>Val_Recall</th>
      <th>Val_Accuracy</th>
      <th>Val_F1</th>
      <th>Val_AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bayesiano</td>
      <td>1.000000e-09</td>
      <td>0.043016</td>
      <td>0.967581</td>
      <td>0.147099</td>
      <td>0.082369</td>
      <td>0.541158</td>
      <td>0.043209</td>
      <td>0.973422</td>
      <td>0.145488</td>
      <td>0.082745</td>
      <td>0.542863</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bayesiano</td>
      <td>1.000000e-08</td>
      <td>0.043025</td>
      <td>0.967165</td>
      <td>0.147642</td>
      <td>0.082385</td>
      <td>0.540995</td>
      <td>0.043238</td>
      <td>0.973422</td>
      <td>0.146080</td>
      <td>0.082798</td>
      <td>0.543302</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bayesiano</td>
      <td>1.000000e-07</td>
      <td>0.043032</td>
      <td>0.966334</td>
      <td>0.148497</td>
      <td>0.082396</td>
      <td>0.541356</td>
      <td>0.043286</td>
      <td>0.973422</td>
      <td>0.147067</td>
      <td>0.082885</td>
      <td>0.543438</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bayesiano</td>
      <td>1.000000e-06</td>
      <td>0.043049</td>
      <td>0.963425</td>
      <td>0.151292</td>
      <td>0.082416</td>
      <td>0.541379</td>
      <td>0.043288</td>
      <td>0.970100</td>
      <td>0.149895</td>
      <td>0.082878</td>
      <td>0.542450</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Bayesiano</td>
      <td>1.000000e-05</td>
      <td>0.043065</td>
      <td>0.962594</td>
      <td>0.152312</td>
      <td>0.082442</td>
      <td>0.541723</td>
      <td>0.043120</td>
      <td>0.965116</td>
      <td>0.150618</td>
      <td>0.082552</td>
      <td>0.542493</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d70beb31-c0f7-47aa-b4ba-7b3f5ae4ff2d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d70beb31-c0f7-47aa-b4ba-7b3f5ae4ff2d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d70beb31-c0f7-47aa-b4ba-7b3f5ae4ff2d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-631b60aa-12fc-45e2-8bdb-3ce8540d2316">
  <button class="colab-df-quickchart" onclick="quickchart('df-631b60aa-12fc-45e2-8bdb-3ce8540d2316')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-631b60aa-12fc-45e2-8bdb-3ce8540d2316 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_118a2f58-ac40-4ad3-953b-59b0ea698960">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('metrics_df_bayesian')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_118a2f58-ac40-4ad3-953b-59b0ea698960 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('metrics_df_bayesian');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor var_smoothing: 1e-05
Precisión de Validación: 0.1506

El mejor modelo ha sido guardado como &#39;best_bayesian_model.joblib&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-l1-l2-penalty-logistic-regression-con-balanceo-de-clases-smoteenn">
<h2>Modelo L1/L2 Penalty Logistic Regression con balanceo de clases SMOTEENN<a class="headerlink" href="#modelo-l1-l2-penalty-logistic-regression-con-balanceo-de-clases-smoteenn" title="Link to this heading">#</a></h2>
<p>Para el modelo de clasificación de regresión logística con penalización L1, L2 se hará una partición de los datos para poder aplicar el balanceo de clases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separar características y objetivo en el conjunto de entrenamiento</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>

<span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Dividir el conjunto de entrenamiento en entrenamiento y validación</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar SMOTEENN solo al conjunto de entrenamiento</span>
<span class="n">smoteenn</span> <span class="o">=</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled_logistic</span><span class="p">,</span> <span class="n">y_resampled_logistic</span> <span class="o">=</span> <span class="n">smoteenn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_l1l2</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)),</span>  <span class="c1"># Manejo de valores faltantes</span>
    <span class="p">(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>  <span class="c1"># Escalado de características</span>
    <span class="p">(</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s2">&quot;saga&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>  <span class="c1"># Modelo base</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Configurar hiperparámetros para GridSearch**</span>
<span class="n">param_grid_l1l2</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;classifier__penalty&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;l1&quot;</span><span class="p">],</span> <span class="s2">&quot;classifier__C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]},</span>  <span class="c1"># Regularización L1</span>
    <span class="p">{</span><span class="s2">&quot;classifier__penalty&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;l2&quot;</span><span class="p">],</span> <span class="s2">&quot;classifier__C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]},</span>  <span class="c1"># Regularización L2</span>
<span class="p">]</span>

<span class="c1"># Crear y ejecutar el GridSearch con validación cruzada**</span>
<span class="n">grid_l1l2</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">pipeline_l1l2</span><span class="p">,</span> <span class="n">param_grid_l1l2</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grid_l1l2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 3 folds for each of 6 candidates, totalling 18 fits
[CV] END ............classifier__C=1, classifier__penalty=l1; total time= 5.4min
[CV] END ............classifier__C=1, classifier__penalty=l1; total time= 5.5min
[CV] END ............classifier__C=1, classifier__penalty=l1; total time= 5.3min
[CV] END ..........classifier__C=0.1, classifier__penalty=l1; total time= 5.2min
[CV] END ..........classifier__C=0.1, classifier__penalty=l1; total time= 5.2min
[CV] END ..........classifier__C=0.1, classifier__penalty=l1; total time= 5.2min
[CV] END .........classifier__C=0.01, classifier__penalty=l1; total time= 5.1min
[CV] END .........classifier__C=0.01, classifier__penalty=l1; total time= 5.1min
[CV] END .........classifier__C=0.01, classifier__penalty=l1; total time= 5.1min
[CV] END ............classifier__C=1, classifier__penalty=l2; total time= 4.2min
[CV] END ............classifier__C=1, classifier__penalty=l2; total time= 4.2min
[CV] END ............classifier__C=1, classifier__penalty=l2; total time= 4.2min
[CV] END ..........classifier__C=0.1, classifier__penalty=l2; total time= 4.2min
[CV] END ..........classifier__C=0.1, classifier__penalty=l2; total time= 4.2min
[CV] END ..........classifier__C=0.1, classifier__penalty=l2; total time= 4.2min
[CV] END .........classifier__C=0.01, classifier__penalty=l2; total time= 4.3min
[CV] END .........classifier__C=0.01, classifier__penalty=l2; total time= 4.2min
[CV] END .........classifier__C=0.01, classifier__penalty=l2; total time= 4.2min
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[(&#x27;imputer&#x27;, SimpleImputer()),
                                       (&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;classifier&#x27;,
                                        LogisticRegression(max_iter=1000,
                                                           random_state=42,
                                                           solver=&#x27;saga&#x27;))]),
             param_grid=[{&#x27;classifier__C&#x27;: [1, 0.1, 0.01],
                          &#x27;classifier__penalty&#x27;: [&#x27;l1&#x27;]},
                         {&#x27;classifier__C&#x27;: [1, 0.1, 0.01],
                          &#x27;classifier__penalty&#x27;: [&#x27;l2&#x27;]}],
             return_train_score=True, scoring=&#x27;accuracy&#x27;, verbose=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" ><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[(&#x27;imputer&#x27;, SimpleImputer()),
                                       (&#x27;scaler&#x27;, StandardScaler()),
                                       (&#x27;classifier&#x27;,
                                        LogisticRegression(max_iter=1000,
                                                           random_state=42,
                                                           solver=&#x27;saga&#x27;))]),
             param_grid=[{&#x27;classifier__C&#x27;: [1, 0.1, 0.01],
                          &#x27;classifier__penalty&#x27;: [&#x27;l1&#x27;]},
                         {&#x27;classifier__C&#x27;: [1, 0.1, 0.01],
                          &#x27;classifier__penalty&#x27;: [&#x27;l2&#x27;]}],
             return_train_score=True, scoring=&#x27;accuracy&#x27;, verbose=2)</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" ><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: Pipeline</label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[(&#x27;imputer&#x27;, SimpleImputer()), (&#x27;scaler&#x27;, StandardScaler()),
                (&#x27;classifier&#x27;,
                 LogisticRegression(C=1, max_iter=1000, random_state=42,
                                    solver=&#x27;saga&#x27;))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;SimpleImputer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.impute.SimpleImputer.html">?<span>Documentation for SimpleImputer</span></a></label><div class="sk-toggleable__content fitted"><pre>SimpleImputer()</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" ><label for="sk-estimator-id-4" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;StandardScaler<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content fitted"><pre>StandardScaler()</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" ><label for="sk-estimator-id-5" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;LogisticRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a></label><div class="sk-toggleable__content fitted"><pre>LogisticRegression(C=1, max_iter=1000, random_state=42, solver=&#x27;saga&#x27;)</pre></div> </div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imprimir los mejores hiperparámetros y la puntuación**</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores hiperparámetros encontrados para L1/L2:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_l1l2</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación de validación para L1/L2: </span><span class="si">{</span><span class="n">grid_l1l2</span><span class="o">.</span><span class="n">best_score_</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros encontrados para L1/L2:
{&#39;classifier__C&#39;: 1, &#39;classifier__penalty&#39;: &#39;l2&#39;}
Mejor puntuación de validación para L1/L2: 0.845739
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluar el modelo con el conjunto de prueba**</span>
<span class="n">best_model_l1l2</span> <span class="o">=</span> <span class="n">grid_l1l2</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">y_pred_l1l2</span> <span class="o">=</span> <span class="n">best_model_l1l2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred_prob_l1l2</span> <span class="o">=</span> <span class="n">best_model_l1l2</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Guardar el modelo en formato .pkl**</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">best_model_l1l2</span><span class="p">,</span> <span class="s1">&#39;modelo_l1l2.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Modelo guardado como &#39;modelo_l1l2.pkl&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo guardado como &#39;modelo_l1l2.pkl&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Métricas**</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Métricas del modelo:&quot;</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_l1l2</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_l1l2</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_l1l2</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_l1l2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1 Score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Métricas del modelo:
Accuracy: 0.8508
Precision: 0.8409
Recall: 0.8799
F1 Score: 0.8600
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matriz de confusión</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_l1l2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matriz de confusión:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matriz de confusión:
[[ 8694  1920]
 [ 1386 10151]]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Verdaderos Negativos (TN): 8,694 (clase 0 correctamente predicha como 0).</p></li>
<li><p>Falsos Positivos (FP): 1,920 (clase 0 incorrectamente predicha como 1).</p></li>
<li><p>Falsos Negativos (FN): 1,386 (clase 1 incorrectamente predicha como 0).</p></li>
<li><p>Verdaderos Positivos (TP): 10,151 (clase 1 correctamente predicha como 1).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar la matriz de confusión</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase 1&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase 1&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicción&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Verdadero&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3196b0ea02c833fb9259cce0b53ad1b311ec166fc82f883188934d758d9b74b0.png" src="_images/3196b0ea02c833fb9259cce0b53ad1b311ec166fc82f883188934d758d9b74b0.png" />
</div>
</div>
<p><strong>Àrea bajo la curva ROC</strong></p>
<p>El modelo muestra un desempeño sólido, con buena precisión, recall y F1-Score. Sin embargo, para aplicaciones sensibles, es necesario reducir los falsos positivos y negativos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># **8. Generar la curva ROC y calcular el AUC**</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_prob_l1l2</span><span class="p">)</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC Curve (AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/11441912f847825515892d56e152e5c9821ab068e5c3fb81b6ec8368a4514799.png" src="_images/11441912f847825515892d56e152e5c9821ab068e5c3fb81b6ec8368a4514799.png" />
</div>
</div>
</section>
<section id="modelo-de-clasificacion-k-nn-con-balanceo-de-clases-smoteenn">
<h2>Modelo de clasificación K-NN con balanceo de clases SMOTEENN<a class="headerlink" href="#modelo-de-clasificacion-k-nn-con-balanceo-de-clases-smoteenn" title="Link to this heading">#</a></h2>
<p>Se hace la particiòn de los datos y el balanceo de clases por cada partición para evitar fuga de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separar características y objetivo en el conjunto de entrenamiento</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>

<span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Dividir el conjunto de entrenamiento en entrenamiento y validación</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar SMOTEENN solo al conjunto de entrenamiento</span>
<span class="n">smoteenn</span> <span class="o">=</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled_KNN</span><span class="p">,</span> <span class="n">y_resampled_KNN</span> <span class="o">=</span> <span class="n">smoteenn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Lista de valores de n_neighbors a evaluar</span>
<span class="n">neighbors_settings</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Crear una lista para almacenar las métricas</span>
<span class="n">metrics_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Variables para rastrear el mejor modelo</span>
<span class="n">best_val_accuracy</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_n_neighbors</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;onehot&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Combinar los transformadores en un preprocesador</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">numerical_transformer</span><span class="p">,</span> <span class="n">numerical_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Iterar sobre los diferentes valores de n_neighbors con tqdm para mostrar el progreso</span>
<span class="k">for</span> <span class="n">n_neighbors</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">neighbors_settings</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Evaluando KNN&quot;</span><span class="p">):</span>
    <span class="c1"># Crear el pipeline con preprocesamiento y KNN</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">))</span>
    <span class="p">])</span>

    <span class="c1"># Entrenar el modelo con el conjunto resampleado</span>
    <span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled_KNN</span><span class="p">,</span> <span class="n">y_resampled_KNN</span><span class="p">)</span>

    <span class="c1"># Predecir en el conjunto de entrenamiento original</span>
    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_train_proba</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calcular métricas para el conjunto de entrenamiento</span>
    <span class="n">train_precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">train_recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">train_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
    <span class="n">train_f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">train_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_proba</span><span class="p">)</span>

    <span class="c1"># Predecir en el conjunto de validación</span>
    <span class="n">y_val_pred</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">y_val_proba</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calcular métricas para el conjunto de validación</span>
    <span class="n">val_precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">val_recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
    <span class="n">val_f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">val_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_proba</span><span class="p">)</span>

    <span class="c1"># Añadir las métricas a la lista</span>
    <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;K-NN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="n">n_neighbors</span><span class="p">,</span>
        <span class="s1">&#39;Train_Precision&#39;</span><span class="p">:</span> <span class="n">train_precision</span><span class="p">,</span>
        <span class="s1">&#39;Train_Recall&#39;</span><span class="p">:</span> <span class="n">train_recall</span><span class="p">,</span>
        <span class="s1">&#39;Train_Accuracy&#39;</span><span class="p">:</span> <span class="n">train_accuracy</span><span class="p">,</span>
        <span class="s1">&#39;Train_F1&#39;</span><span class="p">:</span> <span class="n">train_f1</span><span class="p">,</span>
        <span class="s1">&#39;Train_AUC&#39;</span><span class="p">:</span> <span class="n">train_auc</span><span class="p">,</span>
        <span class="s1">&#39;Val_Precision&#39;</span><span class="p">:</span> <span class="n">val_precision</span><span class="p">,</span>
        <span class="s1">&#39;Val_Recall&#39;</span><span class="p">:</span> <span class="n">val_recall</span><span class="p">,</span>
        <span class="s1">&#39;Val_Accuracy&#39;</span><span class="p">:</span> <span class="n">val_accuracy</span><span class="p">,</span>
        <span class="s1">&#39;Val_F1&#39;</span><span class="p">:</span> <span class="n">val_f1</span><span class="p">,</span>
        <span class="s1">&#39;Val_AUC&#39;</span><span class="p">:</span> <span class="n">val_auc</span>
    <span class="p">})</span>

    <span class="c1"># Verificar si este modelo es el mejor hasta ahora</span>
    <span class="k">if</span> <span class="n">val_accuracy</span> <span class="o">&gt;</span> <span class="n">best_val_accuracy</span><span class="p">:</span>
        <span class="n">best_val_accuracy</span> <span class="o">=</span> <span class="n">val_accuracy</span>
        <span class="n">best_model</span> <span class="o">=</span> <span class="n">pipeline</span>
        <span class="n">best_n_neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span>

    <span class="c1"># Imprimir el progreso similar al ejemplo proporcionado</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n_neighbors: </span><span class="si">{</span><span class="n">n_neighbors</span><span class="si">}</span><span class="s2">, Training Accuracy: </span><span class="si">{</span><span class="n">train_accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Validación Accuracy: </span><span class="si">{</span><span class="n">val_accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Convertir la lista de métricas a un DataFrame</span>
<span class="n">metrics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:   5%|▌         | 1/19 [03:55&lt;1:10:43, 235.75s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 1, Training Accuracy: 0.9314, Validación Accuracy: 0.8665
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  11%|█         | 2/19 [07:44&lt;1:05:41, 231.86s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 2, Training Accuracy: 0.9349, Validación Accuracy: 0.8904
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  16%|█▌        | 3/19 [11:56&lt;1:04:17, 241.08s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 3, Training Accuracy: 0.8932, Validación Accuracy: 0.8564
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  21%|██        | 4/19 [15:45&lt;59:04, 236.28s/it]  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 4, Training Accuracy: 0.9045, Validación Accuracy: 0.8726
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  26%|██▋       | 5/19 [19:34&lt;54:31, 233.66s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 5, Training Accuracy: 0.8770, Validación Accuracy: 0.8494
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  32%|███▏      | 6/19 [23:25&lt;50:23, 232.54s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 6, Training Accuracy: 0.8889, Validación Accuracy: 0.8642
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  37%|███▋      | 7/19 [27:11&lt;46:07, 230.61s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 7, Training Accuracy: 0.8675, Validación Accuracy: 0.8435
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  42%|████▏     | 8/19 [31:02&lt;42:15, 230.51s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 8, Training Accuracy: 0.8789, Validación Accuracy: 0.8570
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  47%|████▋     | 9/19 [34:52&lt;38:24, 230.46s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 9, Training Accuracy: 0.8616, Validación Accuracy: 0.8400
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  53%|█████▎    | 10/19 [38:40&lt;34:26, 229.66s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 10, Training Accuracy: 0.8710, Validación Accuracy: 0.8514
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  58%|█████▊    | 11/19 [42:30&lt;30:37, 229.68s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 11, Training Accuracy: 0.8562, Validación Accuracy: 0.8374
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  63%|██████▎   | 12/19 [46:18&lt;26:45, 229.39s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 12, Training Accuracy: 0.8663, Validación Accuracy: 0.8487
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  68%|██████▊   | 13/19 [50:07&lt;22:55, 229.23s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 13, Training Accuracy: 0.8533, Validación Accuracy: 0.8349
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  74%|███████▎  | 14/19 [53:56&lt;19:05, 229.19s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 14, Training Accuracy: 0.8624, Validación Accuracy: 0.8457
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  79%|███████▉  | 15/19 [57:44&lt;15:14, 228.62s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 15, Training Accuracy: 0.8503, Validación Accuracy: 0.8333
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  84%|████████▍ | 16/19 [1:01:32&lt;11:25, 228.65s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 16, Training Accuracy: 0.8582, Validación Accuracy: 0.8440
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  89%|████████▉ | 17/19 [1:05:19&lt;07:35, 227.94s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 17, Training Accuracy: 0.8481, Validación Accuracy: 0.8343
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN:  95%|█████████▍| 18/19 [1:09:07&lt;03:48, 228.08s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 18, Training Accuracy: 0.8575, Validación Accuracy: 0.8443
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Evaluando KNN: 100%|██████████| 19/19 [1:12:56&lt;00:00, 230.34s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_neighbors: 19, Training Accuracy: 0.8485, Validación Accuracy: 0.8345
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p><strong>Comportamiento entre el score del conjunto de entrenamiento y validación</strong>.</p>
<p>A medida que aumenta k, la precisión de entrenamiento disminuye debido a menor sobreajuste, mientras que la de validación inicialmente mejora y luego disminuye. La mejor precisión de validación ocurre para valores bajos de k, pero más grandes que 1, indicando que valores muy pequeños de k tienden a sobreajustar</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar las precisiones de entrenamiento y validación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">],</span> <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;Train_Accuracy&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Precisión de Entrenamiento&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">],</span> <span class="n">metrics_df</span><span class="p">[</span><span class="s1">&#39;Val_Accuracy&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Precisión de Validación&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Número de Vecinos (n_neighbors)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precisión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Precisión de KNN según el Número de Vecinos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">neighbors_settings</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ff6d818852c68b3267cab9cb7a7bd097295484ebaf99362a887542715050736b.png" src="_images/ff6d818852c68b3267cab9cb7a7bd097295484ebaf99362a887542715050736b.png" />
</div>
</div>
<p>El AUC (Área Bajo la Curva) es de <code class="docutils literal notranslate"><span class="pre">0.9028</span></code> para entrenamiento, indicando un excelente desempeño predictivo en ese conjunto. Sin embargo, el AUC en validación es menor, 0.6713, sugiriendo que el modelo no generaliza bien y puede estar sobreajustado</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generar curvas ROC para el mejor modelo</span>
<span class="n">y_train_proba_best</span> <span class="o">=</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_val_proba_best</span> <span class="o">=</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">fpr_train</span><span class="p">,</span> <span class="n">tpr_train</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_proba_best</span><span class="p">)</span>
<span class="n">fpr_val</span><span class="p">,</span> <span class="n">tpr_val</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_proba_best</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_train</span><span class="p">,</span> <span class="n">tpr_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC Entrenamiento (AUC = </span><span class="si">{</span><span class="n">metrics_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metrics_df</span><span class="p">[</span><span class="s2">&quot;n_neighbors&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">best_n_neighbors</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Train_AUC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_val</span><span class="p">,</span> <span class="n">tpr_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC Validación (AUC = </span><span class="si">{</span><span class="n">metrics_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metrics_df</span><span class="p">[</span><span class="s2">&quot;n_neighbors&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">best_n_neighbors</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Val_AUC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>  <span class="c1"># Línea de referencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Curvas ROC para el Mejor Modelo K-NN (n_neighbors = </span><span class="si">{</span><span class="n">best_n_neighbors</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ecda0f137bf6963e3ceae374207168d667fddffac2f017138f7cb793dec58e15.png" src="_images/ecda0f137bf6963e3ceae374207168d667fddffac2f017138f7cb793dec58e15.png" />
</div>
</div>
<p><strong>Matriz de confusión</strong></p>
<ul class="simple">
<li><p>Verdaderos Negativos (TN): 55,183 (clase 0 correctamente predicha como 0).</p></li>
<li><p>Falsos Positivos (FP): 3,227 (clase 0 predicha incorrectamente como 1).</p></li>
<li><p>Falsos Negativos (FN): 734 (clase 1 predicha incorrectamente como 0).</p></li>
<li><p>Verdaderos Positivos (TP): 1,672 (clase 1 correctamente predicha como 1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generar matrices de confusión para el mejor modelo</span>
<span class="c1"># Para el conjunto de entrenamiento</span>
<span class="n">cm_train</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">disp_train</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="o">=</span><span class="n">cm_train</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="n">best_model</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
<span class="n">disp_train</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matriz de Confusión - Entrenamiento (n_neighbors = </span><span class="si">{</span><span class="n">best_n_neighbors</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3ffe4c6dfcefd0216d214d565fdeeb43c3d360e74fa7f6a7367e49a849a422b3.png" src="_images/3ffe4c6dfcefd0216d214d565fdeeb43c3d360e74fa7f6a7367e49a849a422b3.png" />
</div>
</div>
<ul class="simple">
<li><p>Verdaderos Negativos (TN): 13,335 (clase 0 correctamente predicha como 0).</p></li>
<li><p>Falsos Positivos (FP): 1,267 (clase 0 predicha incorrectamente como 1).</p></li>
<li><p>Falsos Negativos (FN): 400 (clase 1 predicha incorrectamente como 0).</p></li>
<li><p>Verdaderos Positivos (TP): 202 (clase 1 correctamente predicha como 1).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para el conjunto de validación</span>
<span class="n">cm_val</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">))</span>
<span class="n">disp_val</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="o">=</span><span class="n">cm_val</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="n">best_model</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
<span class="n">disp_val</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matriz de Confusión - Validación (n_neighbors = </span><span class="si">{</span><span class="n">best_n_neighbors</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6476c7a73d661bc98ea1cdf5e73e05246cc50217344709d60babaa66b49ab88e.png" src="_images/6476c7a73d661bc98ea1cdf5e73e05246cc50217344709d60babaa66b49ab88e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar el DataFrame con las métricas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Métricas de Evaluación para cada configuración de KNN:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">metrics_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Métricas de Evaluación para cada configuración de KNN:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-1adf5f87-6c26-4f0a-bd3b-7a9cab051b70" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>n_neighbors</th>
      <th>Train_Precision</th>
      <th>Train_Recall</th>
      <th>Train_Accuracy</th>
      <th>Train_F1</th>
      <th>Train_AUC</th>
      <th>Val_Precision</th>
      <th>Val_Recall</th>
      <th>Val_Accuracy</th>
      <th>Val_F1</th>
      <th>Val_AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>1</td>
      <td>0.353255</td>
      <td>0.881962</td>
      <td>0.931449</td>
      <td>0.504457</td>
      <td>0.907725</td>
      <td>0.124276</td>
      <td>0.392027</td>
      <td>0.866548</td>
      <td>0.188725</td>
      <td>0.639069</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K-NN</td>
      <td>2</td>
      <td>0.341294</td>
      <td>0.694929</td>
      <td>0.934869</td>
      <td>0.457769</td>
      <td>0.902791</td>
      <td>0.137509</td>
      <td>0.335548</td>
      <td>0.890358</td>
      <td>0.195075</td>
      <td>0.671336</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K-NN</td>
      <td>3</td>
      <td>0.234614</td>
      <td>0.751039</td>
      <td>0.893219</td>
      <td>0.357539</td>
      <td>0.896009</td>
      <td>0.124763</td>
      <td>0.436877</td>
      <td>0.856354</td>
      <td>0.194096</td>
      <td>0.687842</td>
    </tr>
    <tr>
      <th>3</th>
      <td>K-NN</td>
      <td>4</td>
      <td>0.248521</td>
      <td>0.698254</td>
      <td>0.904532</td>
      <td>0.366572</td>
      <td>0.891076</td>
      <td>0.136636</td>
      <td>0.416944</td>
      <td>0.872599</td>
      <td>0.205822</td>
      <td>0.700922</td>
    </tr>
    <tr>
      <th>4</th>
      <td>K-NN</td>
      <td>5</td>
      <td>0.204336</td>
      <td>0.728595</td>
      <td>0.877022</td>
      <td>0.319162</td>
      <td>0.886713</td>
      <td>0.125942</td>
      <td>0.471761</td>
      <td>0.849448</td>
      <td>0.198810</td>
      <td>0.706300</td>
    </tr>
    <tr>
      <th>5</th>
      <td>K-NN</td>
      <td>6</td>
      <td>0.216103</td>
      <td>0.688279</td>
      <td>0.888894</td>
      <td>0.328930</td>
      <td>0.882355</td>
      <td>0.134798</td>
      <td>0.448505</td>
      <td>0.864180</td>
      <td>0.207294</td>
      <td>0.712295</td>
    </tr>
    <tr>
      <th>6</th>
      <td>K-NN</td>
      <td>7</td>
      <td>0.189430</td>
      <td>0.716542</td>
      <td>0.867486</td>
      <td>0.299644</td>
      <td>0.879069</td>
      <td>0.122986</td>
      <td>0.481728</td>
      <td>0.843462</td>
      <td>0.195946</td>
      <td>0.719794</td>
    </tr>
    <tr>
      <th>7</th>
      <td>K-NN</td>
      <td>8</td>
      <td>0.199175</td>
      <td>0.682461</td>
      <td>0.878881</td>
      <td>0.308357</td>
      <td>0.875461</td>
      <td>0.129595</td>
      <td>0.456811</td>
      <td>0.857011</td>
      <td>0.201909</td>
      <td>0.724135</td>
    </tr>
    <tr>
      <th>8</th>
      <td>K-NN</td>
      <td>9</td>
      <td>0.180737</td>
      <td>0.707398</td>
      <td>0.861566</td>
      <td>0.287913</td>
      <td>0.872537</td>
      <td>0.122785</td>
      <td>0.495017</td>
      <td>0.839976</td>
      <td>0.196765</td>
      <td>0.730154</td>
    </tr>
    <tr>
      <th>9</th>
      <td>K-NN</td>
      <td>10</td>
      <td>0.188331</td>
      <td>0.682876</td>
      <td>0.871021</td>
      <td>0.295238</td>
      <td>0.869502</td>
      <td>0.129638</td>
      <td>0.481728</td>
      <td>0.851421</td>
      <td>0.204297</td>
      <td>0.733799</td>
    </tr>
    <tr>
      <th>10</th>
      <td>K-NN</td>
      <td>11</td>
      <td>0.173416</td>
      <td>0.699501</td>
      <td>0.856206</td>
      <td>0.277929</td>
      <td>0.866998</td>
      <td>0.124498</td>
      <td>0.514950</td>
      <td>0.837411</td>
      <td>0.200517</td>
      <td>0.740338</td>
    </tr>
    <tr>
      <th>11</th>
      <td>K-NN</td>
      <td>12</td>
      <td>0.180896</td>
      <td>0.674564</td>
      <td>0.866285</td>
      <td>0.285287</td>
      <td>0.864839</td>
      <td>0.130548</td>
      <td>0.498339</td>
      <td>0.848724</td>
      <td>0.206897</td>
      <td>0.743858</td>
    </tr>
    <tr>
      <th>12</th>
      <td>K-NN</td>
      <td>13</td>
      <td>0.169424</td>
      <td>0.693682</td>
      <td>0.853345</td>
      <td>0.272334</td>
      <td>0.862025</td>
      <td>0.124409</td>
      <td>0.524917</td>
      <td>0.834912</td>
      <td>0.201146</td>
      <td>0.745623</td>
    </tr>
    <tr>
      <th>13</th>
      <td>K-NN</td>
      <td>14</td>
      <td>0.175946</td>
      <td>0.672485</td>
      <td>0.862438</td>
      <td>0.278917</td>
      <td>0.859784</td>
      <td>0.128936</td>
      <td>0.503322</td>
      <td>0.845699</td>
      <td>0.205285</td>
      <td>0.748093</td>
    </tr>
    <tr>
      <th>14</th>
      <td>K-NN</td>
      <td>15</td>
      <td>0.165452</td>
      <td>0.688695</td>
      <td>0.850253</td>
      <td>0.266806</td>
      <td>0.857838</td>
      <td>0.122018</td>
      <td>0.518272</td>
      <td>0.833268</td>
      <td>0.197531</td>
      <td>0.751893</td>
    </tr>
    <tr>
      <th>15</th>
      <td>K-NN</td>
      <td>16</td>
      <td>0.169921</td>
      <td>0.665420</td>
      <td>0.858162</td>
      <td>0.270714</td>
      <td>0.855882</td>
      <td>0.129397</td>
      <td>0.513289</td>
      <td>0.843988</td>
      <td>0.206689</td>
      <td>0.754861</td>
    </tr>
    <tr>
      <th>16</th>
      <td>K-NN</td>
      <td>17</td>
      <td>0.161798</td>
      <td>0.679135</td>
      <td>0.848116</td>
      <td>0.261335</td>
      <td>0.854651</td>
      <td>0.124804</td>
      <td>0.529900</td>
      <td>0.834254</td>
      <td>0.202027</td>
      <td>0.756039</td>
    </tr>
    <tr>
      <th>17</th>
      <td>K-NN</td>
      <td>18</td>
      <td>0.168380</td>
      <td>0.660432</td>
      <td>0.857521</td>
      <td>0.268344</td>
      <td>0.853375</td>
      <td>0.131524</td>
      <td>0.523256</td>
      <td>0.844317</td>
      <td>0.210210</td>
      <td>0.757902</td>
    </tr>
    <tr>
      <th>18</th>
      <td>K-NN</td>
      <td>19</td>
      <td>0.161207</td>
      <td>0.672901</td>
      <td>0.848543</td>
      <td>0.260101</td>
      <td>0.851828</td>
      <td>0.127336</td>
      <td>0.543189</td>
      <td>0.834517</td>
      <td>0.206309</td>
      <td>0.759816</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1adf5f87-6c26-4f0a-bd3b-7a9cab051b70')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1adf5f87-6c26-4f0a-bd3b-7a9cab051b70 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1adf5f87-6c26-4f0a-bd3b-7a9cab051b70');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-32d7f511-407d-4a6e-8646-946b081a563e">
  <button class="colab-df-quickchart" onclick="quickchart('df-32d7f511-407d-4a6e-8646-946b081a563e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-32d7f511-407d-4a6e-8646-946b081a563e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_b8bf5841-59d1-4dbb-a0cf-16e822365a51">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('metrics_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_b8bf5841-59d1-4dbb-a0cf-16e822365a51 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('metrics_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar el mejor modelo encontrado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejor n_neighbors: </span><span class="si">{</span><span class="n">best_n_neighbors</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precisión de Validación: </span><span class="si">{</span><span class="n">best_val_accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Guardar el mejor modelo entrenado con joblib</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">best_model</span><span class="p">,</span> <span class="s1">&#39;best_knn_model.joblib&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">El mejor modelo ha sido guardado como &#39;best_knn_model.joblib&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor n_neighbors: 2
Precisión de Validación: 0.8904

El mejor modelo ha sido guardado como &#39;best_knn_model.joblib&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="c1"># Realizar predicciones de clase</span>
<span class="n">test_predictions</span> <span class="o">=</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Realizar predicciones de probabilidad (opcional)</span>
<span class="n">test_proba</span> <span class="o">=</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">test_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">test_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Predicted_TARGET&#39;</span><span class="p">:</span> <span class="n">test_predictions</span><span class="p">,</span>
        <span class="s1">&#39;Predicted_PROBA&#39;</span><span class="p">:</span> <span class="n">test_proba</span>
    <span class="p">})</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">test_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;Row_Index&#39;</span><span class="p">:</span> <span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="s1">&#39;Predicted_TARGET&#39;</span><span class="p">:</span> <span class="n">test_predictions</span><span class="p">,</span>
        <span class="s1">&#39;Predicted_PROBA&#39;</span><span class="p">:</span> <span class="n">test_proba</span>
    <span class="p">})</span>

<span class="c1"># Mostrar las primeras filas de las predicciones</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Primeras filas de las predicciones en el conjunto de test:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">test_results</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Guardar las predicciones en un archivo CSV</span>
<span class="n">test_results</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;test_predictions.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Las predicciones en el conjunto de test han sido guardadas como &#39;test_predictions.csv&#39;.&quot;</span><span class="p">)</span>

<span class="c1"># (Opcional) Descargar el archivo CSV en Google Colab</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>
<span class="n">files</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;test_predictions.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Primeras filas de las predicciones en el conjunto de test:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-463ac4f6-5006-4224-9875-eef1298710a4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Row_Index</th>
      <th>Predicted_TARGET</th>
      <th>Predicted_PROBA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-463ac4f6-5006-4224-9875-eef1298710a4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-463ac4f6-5006-4224-9875-eef1298710a4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-463ac4f6-5006-4224-9875-eef1298710a4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6836db4a-7a53-4e95-9986-3e1ffce4ea80">
  <button class="colab-df-quickchart" onclick="quickchart('df-6836db4a-7a53-4e95-9986-3e1ffce4ea80')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6836db4a-7a53-4e95-9986-3e1ffce4ea80 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Las predicciones en el conjunto de test han sido guardadas como &#39;test_predictions.csv&#39;.
</pre></div>
</div>
<script type="application/javascript">
    async function download(id, filename, size) {
      if (!google.colab.kernel.accessAllowed) {
        return;
      }
      const div = document.createElement('div');
      const label = document.createElement('label');
      label.textContent = `Downloading "${filename}": `;
      div.appendChild(label);
      const progress = document.createElement('progress');
      progress.max = size;
      div.appendChild(progress);
      document.body.appendChild(div);

      const buffers = [];
      let downloaded = 0;

      const channel = await google.colab.kernel.comms.open(id);
      // Send a message to notify the kernel that we're ready.
      channel.send({})

      for await (const message of channel.messages) {
        // Send a message to notify the kernel that we're ready.
        channel.send({})
        if (message.buffers) {
          for (const buffer of message.buffers) {
            buffers.push(buffer);
            downloaded += buffer.byteLength;
            progress.value = downloaded;
          }
        }
      }
      const blob = new Blob(buffers, {type: 'application/binary'});
      const a = document.createElement('a');
      a.href = window.URL.createObjectURL(blob);
      a.download = filename;
      div.appendChild(a);
      a.click();
      div.remove();
    }
  </script><script type="application/javascript">download("download_d0d08a55-eaec-4622-af51-3984cb1b858e", "test_predictions.csv", 898749)</script></div>
</div>
</section>
<section id="xgboost-con-balanceo-de-clase-smoteenn">
<h2>XGBoost con balanceo de clase SMOTEENN<a class="headerlink" href="#xgboost-con-balanceo-de-clase-smoteenn" title="Link to this heading">#</a></h2>
<p>Se realiza balanceo de clases posterior a la partición o división de conjuntos de entrenamiento y validacion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separar características y objetivo en el conjunto de entrenamiento</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>

<span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Dividir el conjunto de entrenamiento en entrenamiento y validación</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar SMOTEENN solo al conjunto de entrenamiento</span>
<span class="n">smoteenn</span> <span class="o">=</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled_xgb</span><span class="p">,</span> <span class="n">y_resampled_xgb</span> <span class="o">=</span> <span class="n">smoteenn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;xgbclassifier__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>        <span class="c1"># Número de árboles</span>
    <span class="s1">&#39;xgbclassifier__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>              <span class="c1"># Profundidad máxima de los árboles</span>
    <span class="s1">&#39;xgbclassifier__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>     <span class="c1"># Tasa de aprendizaje</span>
    <span class="s1">&#39;xgbclassifier__subsample&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>            <span class="c1"># Submuestreo de muestras</span>
    <span class="s1">&#39;xgbclassifier__colsample_bytree&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>      <span class="c1"># Submuestreo de columnas</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;onehot&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Combinar los transformadores en un preprocesador</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">numerical_transformer</span><span class="p">,</span> <span class="n">numerical_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear el pipeline con preprocesamiento y XGBoost</span>
<span class="n">pipeline_xgb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;xgbclassifier&#39;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span>
        <span class="n">use_label_encoder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;logloss&#39;</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">))</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configurar GridSearchCV para la búsqueda de hiperparámetros</span>
<span class="n">grid_search_xgb</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_xgb</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>                      <span class="c1"># Número de pliegues en la validación cruzada</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>        <span class="c1"># Métrica a optimizar</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Entrenar el modelo con el conjunto resampleado</span>
<span class="n">grid_search_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled_xgb</span><span class="p">,</span> <span class="n">y_resampled_xgb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 3 folds for each of 32 candidates, totalling 96 fits
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=  12.9s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   8.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   3.3s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.2s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.5s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   5.1s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   4.8s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   7.8s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   7.0s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   7.8s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   4.6s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   7.2s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   4.5s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   4.3s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   7.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   4.3s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   7.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   4.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  10.0s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   7.7s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  12.9s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=  30.9s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   9.5s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   9.5s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   3.3s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   3.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   5.7s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.6s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.3s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   8.2s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   5.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   8.6s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   5.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   8.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   5.3s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   8.0s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   5.7s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   7.8s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   4.9s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   7.9s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   4.9s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  11.5s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  11.6s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  11.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   8.4s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=  11.7s
[CV] END xgbclassifier__colsample_bytree=0.8, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=  11.8s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   3.2s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   6.2s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   3.3s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.8s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   6.2s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.1s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   4.9s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   7.8s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   4.7s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   7.9s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   7.8s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   7.4s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   4.5s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   7.3s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   4.5s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   4.4s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   7.0s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   4.3s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  10.3s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  10.2s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   7.0s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   9.9s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   6.9s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.1, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   8.9s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   3.4s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   6.4s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   3.4s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.4s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   6.5s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   3.4s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   5.6s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   8.2s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   5.5s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   8.2s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   5.5s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=3, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=   8.4s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   5.1s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   8.2s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=0.8; total time=   5.1s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   8.2s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   5.1s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=100, xgbclassifier__subsample=1; total time=   8.1s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  12.1s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=   8.9s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=0.8; total time=  11.6s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=  12.0s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=  12.1s
[CV] END xgbclassifier__colsample_bytree=1, xgbclassifier__learning_rate=0.01, xgbclassifier__max_depth=6, xgbclassifier__n_estimators=200, xgbclassifier__subsample=1; total time=  11.9s
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[(&#x27;preprocessor&#x27;,
                                        ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                                         Pipeline(steps=[(&#x27;scaler&#x27;,
                                                                                          StandardScaler())]),
                                                                         [&#x27;imp_ent_var16_ult1&#x27;,
                                                                          &#x27;imp_op_var40_comer_ult1&#x27;,
                                                                          &#x27;imp_op_var40_comer_ult3&#x27;,
                                                                          &#x27;imp_op_var40_efect_ult1&#x27;,
                                                                          &#x27;imp_op_var40_efect_ult3&#x27;,
                                                                          &#x27;imp_op_var40_ult1&#x27;,
                                                                          &#x27;imp_op_var41_comer_ult1&#x27;,
                                                                          &#x27;imp_op_var41_comer_ult3&#x27;,
                                                                          &#x27;imp_op...
                                                      monotone_constraints=None,
                                                      multi_strategy=None,
                                                      n_estimators=None,
                                                      n_jobs=None,
                                                      num_parallel_tree=None,
                                                      random_state=42, ...))]),
             param_grid={&#x27;xgbclassifier__colsample_bytree&#x27;: [0.8, 1],
                         &#x27;xgbclassifier__learning_rate&#x27;: [0.1, 0.01],
                         &#x27;xgbclassifier__max_depth&#x27;: [3, 6],
                         &#x27;xgbclassifier__n_estimators&#x27;: [100, 200],
                         &#x27;xgbclassifier__subsample&#x27;: [0.8, 1]},
             scoring=&#x27;accuracy&#x27;, verbose=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" ><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[(&#x27;preprocessor&#x27;,
                                        ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                                         Pipeline(steps=[(&#x27;scaler&#x27;,
                                                                                          StandardScaler())]),
                                                                         [&#x27;imp_ent_var16_ult1&#x27;,
                                                                          &#x27;imp_op_var40_comer_ult1&#x27;,
                                                                          &#x27;imp_op_var40_comer_ult3&#x27;,
                                                                          &#x27;imp_op_var40_efect_ult1&#x27;,
                                                                          &#x27;imp_op_var40_efect_ult3&#x27;,
                                                                          &#x27;imp_op_var40_ult1&#x27;,
                                                                          &#x27;imp_op_var41_comer_ult1&#x27;,
                                                                          &#x27;imp_op_var41_comer_ult3&#x27;,
                                                                          &#x27;imp_op...
                                                      monotone_constraints=None,
                                                      multi_strategy=None,
                                                      n_estimators=None,
                                                      n_jobs=None,
                                                      num_parallel_tree=None,
                                                      random_state=42, ...))]),
             param_grid={&#x27;xgbclassifier__colsample_bytree&#x27;: [0.8, 1],
                         &#x27;xgbclassifier__learning_rate&#x27;: [0.1, 0.01],
                         &#x27;xgbclassifier__max_depth&#x27;: [3, 6],
                         &#x27;xgbclassifier__n_estimators&#x27;: [100, 200],
                         &#x27;xgbclassifier__subsample&#x27;: [0.8, 1]},
             scoring=&#x27;accuracy&#x27;, verbose=2)</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" ><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: Pipeline</label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                 ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                  Pipeline(steps=[(&#x27;scaler&#x27;,
                                                                   StandardScaler())]),
                                                  [&#x27;imp_ent_var16_ult1&#x27;,
                                                   &#x27;imp_op_var40_comer_ult1&#x27;,
                                                   &#x27;imp_op_var40_comer_ult3&#x27;,
                                                   &#x27;imp_op_var40_efect_ult1&#x27;,
                                                   &#x27;imp_op_var40_efect_ult3&#x27;,
                                                   &#x27;imp_op_var40_ult1&#x27;,
                                                   &#x27;imp_op_var41_comer_ult1&#x27;,
                                                   &#x27;imp_op_var41_comer_ult3&#x27;,
                                                   &#x27;imp_op_var39_efect_ult1&#x27;,
                                                   &#x27;imp_op_v...
                               feature_types=None, gamma=None, grow_policy=None,
                               importance_type=None,
                               interaction_constraints=None, learning_rate=0.1,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=6, max_leaves=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=200, n_jobs=None,
                               num_parallel_tree=None, random_state=42, ...))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;preprocessor: ColumnTransformer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.compose.ColumnTransformer.html">?<span>Documentation for preprocessor: ColumnTransformer</span></a></label><div class="sk-toggleable__content fitted"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                 Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler())]),
                                 [&#x27;imp_ent_var16_ult1&#x27;,
                                  &#x27;imp_op_var40_comer_ult1&#x27;,
                                  &#x27;imp_op_var40_comer_ult3&#x27;,
                                  &#x27;imp_op_var40_efect_ult1&#x27;,
                                  &#x27;imp_op_var40_efect_ult3&#x27;,
                                  &#x27;imp_op_var40_ult1&#x27;,
                                  &#x27;imp_op_var41_comer_ult1&#x27;,
                                  &#x27;imp_op_var41_comer_ult3&#x27;,
                                  &#x27;imp_op_var39_efect_ult1&#x27;,
                                  &#x27;imp_op_var39_efect_ult3&#x27;,
                                  &#x27;imp_sal_var16_...
                                  &#x27;saldo_var33&#x27;, &#x27;saldo_var37&#x27;, &#x27;saldo_var40&#x27;,
                                  &#x27;saldo_var44&#x27;, &#x27;delta_imp_aport_var13_1y3&#x27;,
                                  &#x27;delta_imp_aport_var17_1y3&#x27;,
                                  &#x27;delta_imp_aport_var33_1y3&#x27;,
                                  &#x27;delta_imp_compra_var44_1y3&#x27;,
                                  &#x27;delta_imp_venta_var44_1y3&#x27;,
                                  &#x27;imp_amort_var18_ult1&#x27;,
                                  &#x27;imp_amort_var34_ult1&#x27;,
                                  &#x27;imp_aport_var13_hace3&#x27;,
                                  &#x27;imp_aport_var13_ult1&#x27;, ...]),
                                (&#x27;cat&#x27;,
                                 Pipeline(steps=[(&#x27;onehot&#x27;,
                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;))]),
                                 [])])</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" ><label for="sk-estimator-id-4" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">num</label><div class="sk-toggleable__content fitted"><pre>[&#x27;imp_ent_var16_ult1&#x27;, &#x27;imp_op_var40_comer_ult1&#x27;, &#x27;imp_op_var40_comer_ult3&#x27;, &#x27;imp_op_var40_efect_ult1&#x27;, &#x27;imp_op_var40_efect_ult3&#x27;, &#x27;imp_op_var40_ult1&#x27;, &#x27;imp_op_var41_comer_ult1&#x27;, &#x27;imp_op_var41_comer_ult3&#x27;, &#x27;imp_op_var39_efect_ult1&#x27;, &#x27;imp_op_var39_efect_ult3&#x27;, &#x27;imp_sal_var16_ult1&#x27;, &#x27;saldo_var5&#x27;, &#x27;saldo_var8&#x27;, &#x27;saldo_var13_largo&#x27;, &#x27;saldo_var14&#x27;, &#x27;saldo_var25&#x27;, &#x27;saldo_var29&#x27;, &#x27;saldo_var33&#x27;, &#x27;saldo_var37&#x27;, &#x27;saldo_var40&#x27;, &#x27;saldo_var44&#x27;, &#x27;delta_imp_aport_var13_1y3&#x27;, &#x27;delta_imp_aport_var17_1y3&#x27;, &#x27;delta_imp_aport_var33_1y3&#x27;, &#x27;delta_imp_compra_var44_1y3&#x27;, &#x27;delta_imp_venta_var44_1y3&#x27;, &#x27;imp_amort_var18_ult1&#x27;, &#x27;imp_amort_var34_ult1&#x27;, &#x27;imp_aport_var13_hace3&#x27;, &#x27;imp_aport_var13_ult1&#x27;, &#x27;imp_aport_var17_ult1&#x27;, &#x27;imp_var7_emit_ult1&#x27;, &#x27;imp_var7_recib_ult1&#x27;, &#x27;imp_compra_var44_hace3&#x27;, &#x27;imp_reemb_var13_ult1&#x27;, &#x27;imp_reemb_var17_hace3&#x27;, &#x27;imp_reemb_var17_ult1&#x27;, &#x27;imp_var43_emit_ult1&#x27;, &#x27;imp_trans_var37_ult1&#x27;, &#x27;imp_trasp_var17_in_hace3&#x27;, &#x27;imp_trasp_var17_in_ult1&#x27;, &#x27;imp_trasp_var17_out_ult1&#x27;, &#x27;imp_trasp_var33_in_hace3&#x27;, &#x27;imp_trasp_var33_in_ult1&#x27;, &#x27;imp_venta_var44_hace3&#x27;, &#x27;imp_venta_var44_ult1&#x27;, &#x27;saldo_medio_var5_hace2&#x27;, &#x27;saldo_medio_var5_hace3&#x27;, &#x27;saldo_medio_var5_ult1&#x27;, &#x27;saldo_medio_var5_ult3&#x27;, &#x27;saldo_medio_var8_hace2&#x27;, &#x27;saldo_medio_var8_hace3&#x27;, &#x27;saldo_medio_var8_ult3&#x27;, &#x27;saldo_medio_var12_hace2&#x27;, &#x27;saldo_medio_var12_hace3&#x27;, &#x27;saldo_medio_var13_corto_hace3&#x27;, &#x27;saldo_medio_var13_corto_ult1&#x27;, &#x27;saldo_medio_var13_largo_hace2&#x27;, &#x27;saldo_medio_var13_largo_hace3&#x27;, &#x27;saldo_medio_var13_largo_ult1&#x27;, &#x27;saldo_medio_var13_medio_hace2&#x27;, &#x27;saldo_medio_var17_ult1&#x27;, &#x27;saldo_medio_var29_hace2&#x27;, &#x27;saldo_medio_var29_hace3&#x27;, &#x27;saldo_medio_var29_ult3&#x27;, &#x27;saldo_medio_var33_hace2&#x27;, &#x27;saldo_medio_var33_hace3&#x27;, &#x27;saldo_medio_var44_hace2&#x27;, &#x27;saldo_medio_var44_hace3&#x27;, &#x27;var38&#x27;, &#x27;num_var35&#x27;, &#x27;ind_var41_0&#x27;, &#x27;num_var13_corto&#x27;, &#x27;num_op_var41_ult1&#x27;, &#x27;num_var31&#x27;, &#x27;ind_var43_recib_ult1&#x27;, &#x27;num_var22_ult1&#x27;, &#x27;num_reemb_var17_ult1&#x27;, &#x27;ind_var26&#x27;, &#x27;num_var24_0&#x27;, &#x27;num_op_var41_efect_ult1&#x27;, &#x27;ind_var8&#x27;, &#x27;ind_var25_cte&#x27;, &#x27;num_var8_0&#x27;, &#x27;ind_var20&#x27;, &#x27;num_var26_0&#x27;, &#x27;num_var39_0&#x27;, &#x27;ind_var39_0&#x27;, &#x27;num_var17_0&#x27;, &#x27;num_var14_0&#x27;, &#x27;num_var30_0&#x27;, &#x27;ind_var40&#x27;, &#x27;num_var13_corto_0&#x27;, &#x27;num_meses_var13_largo_ult3&#x27;, &#x27;ind_var5&#x27;, &#x27;num_var39&#x27;, &#x27;num_meses_var12_ult3&#x27;, &#x27;num_var25_0&#x27;, &#x27;num_var8&#x27;, &#x27;num_meses_var8_ult3&#x27;, &#x27;num_var45_ult3&#x27;, &#x27;num_op_var39_efect_ult1&#x27;, &#x27;ind_var26_0&#x27;, &#x27;ind_var25_0&#x27;, &#x27;ind_var26_cte&#x27;, &#x27;num_aport_var13_hace3&#x27;, &#x27;num_var25&#x27;, &#x27;num_var13_largo&#x27;, &#x27;ind_var24_0&#x27;, &#x27;num_var4&#x27;, &#x27;num_meses_var39_vig_ult3&#x27;, &#x27;num_var22_hace2&#x27;, &#x27;var21&#x27;, &#x27;ind_var30&#x27;, &#x27;num_op_var41_comer_ult1&#x27;, &#x27;num_var12_0&#x27;, &#x27;ind_var24&#x27;, &#x27;num_var5&#x27;, &#x27;var15&#x27;, &#x27;num_op_var39_ult3&#x27;, &#x27;ind_var8_0&#x27;, &#x27;num_op_var39_efect_ult3&#x27;, &#x27;num_var13_0&#x27;, &#x27;ind_var13_0&#x27;, &#x27;num_var45_ult1&#x27;, &#x27;ind_var1&#x27;, &#x27;num_var42_0&#x27;, &#x27;num_var30&#x27;, &#x27;ind_var31&#x27;, &#x27;ind_var9_cte_ult1&#x27;, &#x27;ind_var25&#x27;, &#x27;ind_var13_largo_0&#x27;, &#x27;ind_var20_0&#x27;, &#x27;ind_var12_0&#x27;, &#x27;ind_var9_ult1&#x27;, &#x27;num_med_var45_ult3&#x27;, &#x27;num_var31_0&#x27;, &#x27;num_var45_hace2&#x27;, &#x27;num_var20_0&#x27;, &#x27;ind_var10cte_ult1&#x27;, &#x27;num_var13_largo_0&#x27;, &#x27;ind_var39&#x27;, &#x27;num_var1_0&#x27;, &#x27;num_op_var39_ult1&#x27;, &#x27;num_op_var40_efect_ult1&#x27;, &#x27;num_var13&#x27;, &#x27;num_var45_hace3&#x27;, &#x27;num_op_var40_efect_ult3&#x27;, &#x27;ind_var12&#x27;, &#x27;num_var40_0&#x27;, &#x27;num_op_var41_efect_ult3&#x27;, &#x27;num_var5_0&#x27;, &#x27;num_var22_ult3&#x27;, &#x27;num_var1&#x27;, &#x27;num_op_var41_ult3&#x27;, &#x27;num_var40&#x27;, &#x27;ind_var31_0&#x27;, &#x27;ind_var30_0&#x27;, &#x27;ind_var13_corto&#x27;, &#x27;ind_var19&#x27;, &#x27;num_var22_hace3&#x27;, &#x27;num_meses_var5_ult3&#x27;, &#x27;ind_var13_corto_0&#x27;, &#x27;num_var42&#x27;, &#x27;ind_var13&#x27;, &#x27;num_var41_0&#x27;, &#x27;ind_var13_largo&#x27;, &#x27;ind_var14_0&#x27;, &#x27;num_var26&#x27;, &#x27;ind_var10_ult1&#x27;, &#x27;num_meses_var13_corto_ult3&#x27;, &#x27;num_var12&#x27;, &#x27;var36&#x27;, &#x27;num_var20&#x27;, &#x27;num_med_var22_ult3&#x27;, &#x27;num_var24&#x27;, &#x27;num_var43_emit_ult1&#x27;, &#x27;num_aport_var17_ult1&#x27;, &#x27;num_var37_med_ult2&#x27;, &#x27;num_op_var39_comer_ult1&#x27;, &#x27;ind_var5_0&#x27;]</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" ><label for="sk-estimator-id-5" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;StandardScaler<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content fitted"><pre>StandardScaler()</pre></div> </div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" ><label for="sk-estimator-id-6" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">cat</label><div class="sk-toggleable__content fitted"><pre>[]</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" ><label for="sk-estimator-id-7" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;OneHotEncoder<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.OneHotEncoder.html">?<span>Documentation for OneHotEncoder</span></a></label><div class="sk-toggleable__content fitted"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div> </div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" ><label for="sk-estimator-id-8" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">XGBClassifier</label><div class="sk-toggleable__content fitted"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.8, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=&#x27;logloss&#x27;,
              feature_types=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=200,
              n_jobs=None, num_parallel_tree=None, random_state=42, ...)</pre></div> </div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtener el mejor modelo</span>
<span class="n">best_model_xgb</span> <span class="o">=</span> <span class="n">grid_search_xgb</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">best_params_xgb</span> <span class="o">=</span> <span class="n">grid_search_xgb</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_val_accuracy_xgb</span> <span class="o">=</span> <span class="n">grid_search_xgb</span><span class="o">.</span><span class="n">best_score_</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Mejores</span> <span class="pre">parámetros</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">colsample_bytree</span></code>: 0.8: Utiliza el 80% de las características en cada árbol para mejorar la diversidad.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">learning_rate</span></code>: 0.1: Tasa de aprendizaje moderada para un ajuste gradual.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_depth</span></code>: 6: Árboles con profundidad controlada para evitar sobreajuste.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_estimators</span></code>: 200: Construcción de 200 árboles para capturar patrones complejos.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subsample</span></code>: 0.8: Usa el 80% de las observaciones para entrenar cada árbol.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros para XGBoost: </span><span class="si">{</span><span class="n">best_params_xgb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor precisión de validación en cross-validation: </span><span class="si">{</span><span class="n">best_val_accuracy_xgb</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros para XGBoost: {&#39;xgbclassifier__colsample_bytree&#39;: 0.8, &#39;xgbclassifier__learning_rate&#39;: 0.1, &#39;xgbclassifier__max_depth&#39;: 6, &#39;xgbclassifier__n_estimators&#39;: 200, &#39;xgbclassifier__subsample&#39;: 0.8}
Mejor precisión de validación en cross-validation: 0.9559
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluar el mejor modelo en el conjunto de validación</span>
<span class="n">y_val_pred_xgb</span> <span class="o">=</span> <span class="n">best_model_xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">y_val_proba_xgb</span> <span class="o">=</span> <span class="n">best_model_xgb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular métricas para el conjunto de validación</span>
<span class="n">val_precision_xgb</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_xgb</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">val_recall_xgb</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_xgb</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">val_accuracy_xgb</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_xgb</span><span class="p">)</span>
<span class="n">val_f1_xgb</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_xgb</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">val_auc_xgb</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_proba_xgb</span><span class="p">)</span>

<span class="c1"># Almacenar el AUC en una variable específica</span>
<span class="n">auc_xgb</span> <span class="o">=</span> <span class="n">val_auc_xgb</span>

<span class="c1"># Imprimir las métricas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Métricas de Evaluación en el Conjunto de Validación:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precisión: </span><span class="si">{</span><span class="n">val_precision_xgb</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">val_recall_xgb</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">val_accuracy_xgb</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-Score: </span><span class="si">{</span><span class="n">val_f1_xgb</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AUC: </span><span class="si">{</span><span class="n">val_auc_xgb</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Métricas de Evaluación en el Conjunto de Validación:
Precisión: 0.1823
Recall: 0.5000
Accuracy: 0.8914
F1-Score: 0.2672
AUC: 0.8331
</pre></div>
</div>
</div>
</div>
<p><strong>Precición media vs Learning Rate para estimadores diferentes de XGBoost</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n_estimators</span></code>=200 consistentemente supera a n_estimators=100 en todas las tasas de aprendizaje, logrando una mejor precisión.</p></li>
<li><p>A medida que el learning rate aumenta, la precisión media CV mejora para ambos valores de n_estimators.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualizar los resultados de GridSearch</span>
<span class="n">results_xgb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grid_search_xgb</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">param_grid</span><span class="p">[</span><span class="s1">&#39;xgbclassifier__n_estimators&#39;</span><span class="p">]:</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">results_xgb</span><span class="p">[</span><span class="n">results_xgb</span><span class="p">[</span><span class="s1">&#39;param_xgbclassifier__n_estimators&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">est</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;param_xgbclassifier__learning_rate&#39;</span><span class="p">],</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n_estimators=</span><span class="si">{</span><span class="n">est</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>  <span class="c1"># Escala logarítmica para learning_rate</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Learning Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precisión Media CV&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Precisión Media CV vs. Learning Rate para diferentes n_estimators en XGBoost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c208bc2bdd72939df0774ba047489ca6a92c458f651f37a504d2205c745d18e4.png" src="_images/c208bc2bdd72939df0774ba047489ca6a92c458f651f37a504d2205c745d18e4.png" />
</div>
</div>
<p><strong>Curva de ROC</strong></p>
<p>La curva se aproxima al vértice superior izquierdo, lo que refleja una buena combinación de Tasa de Verdaderos Positivos (TPR) y baja Tasa de Falsos Positivos (FPR)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generar curva ROC para el conjunto de validación</span>
<span class="n">fpr_xgb</span><span class="p">,</span> <span class="n">tpr_xgb</span><span class="p">,</span> <span class="n">thresholds_xgb</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_proba_xgb</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_xgb</span><span class="p">,</span> <span class="n">tpr_xgb</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC Validación (AUC = </span><span class="si">{</span><span class="n">val_auc_xgb</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>  <span class="c1"># Línea de referencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC para el Modelo XGBoost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/61438f793518ce1300530411bad2af751241d4affe674c72bab9ad9a4676fe34.png" src="_images/61438f793518ce1300530411bad2af751241d4affe674c72bab9ad9a4676fe34.png" />
</div>
</div>
<ul class="simple">
<li><p>Verdaderos Negativos (TN): 13,252 Observaciones de la clase 0 correctamente clasificadas como 0.</p></li>
<li><p>Falsos Positivos (FP): 1,350 Observaciones de la clase 0 incorrectamente clasificadas como 1.</p></li>
<li><p>Falsos Negativos (FN): 301 Observaciones de la clase 1 incorrectamente clasificadas como 0.</p></li>
<li><p>Verdaderos Positivos (TP): 301 Observaciones de la clase 1 correctamente clasificadas como 1.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generar matriz de confusión para el conjunto de validación</span>
<span class="n">cm_xgb</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_xgb</span><span class="p">)</span>
<span class="n">disp_xgb</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="o">=</span><span class="n">cm_xgb</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="n">best_model_xgb</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
<span class="n">disp_xgb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión - Validación (XGBoost)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7865c8b43cbdc9a64671965398ac366bacd7176dc4287041d874f63b28d16965.png" src="_images/7865c8b43cbdc9a64671965398ac366bacd7176dc4287041d874f63b28d16965.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar el DataFrame con las métricas de GridSearch</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Métricas de Evaluación para cada configuración de XGBoost:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">results_xgb</span><span class="p">[[</span><span class="s1">&#39;param_xgbclassifier__n_estimators&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;param_xgbclassifier__max_depth&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;param_xgbclassifier__learning_rate&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;param_xgbclassifier__subsample&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;param_xgbclassifier__colsample_bytree&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;mean_test_score&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;std_test_score&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;rank_test_score&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Métricas de Evaluación para cada configuración de XGBoost:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-587405ce-cf93-4781-b3a8-5b4a3486bb6a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>param_xgbclassifier__n_estimators</th>
      <th>param_xgbclassifier__max_depth</th>
      <th>param_xgbclassifier__learning_rate</th>
      <th>param_xgbclassifier__subsample</th>
      <th>param_xgbclassifier__colsample_bytree</th>
      <th>mean_test_score</th>
      <th>std_test_score</th>
      <th>rank_test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>3</td>
      <td>0.10</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.930353</td>
      <td>0.011723</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100</td>
      <td>3</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.8</td>
      <td>0.929988</td>
      <td>0.011392</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>200</td>
      <td>3</td>
      <td>0.10</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.941877</td>
      <td>0.012911</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>200</td>
      <td>3</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.8</td>
      <td>0.941363</td>
      <td>0.013003</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>100</td>
      <td>6</td>
      <td>0.10</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.950200</td>
      <td>0.013366</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>100</td>
      <td>6</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.8</td>
      <td>0.950246</td>
      <td>0.013229</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>200</td>
      <td>6</td>
      <td>0.10</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.955905</td>
      <td>0.014490</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>200</td>
      <td>6</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.8</td>
      <td>0.954545</td>
      <td>0.013989</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>100</td>
      <td>3</td>
      <td>0.01</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.862719</td>
      <td>0.006700</td>
      <td>32</td>
    </tr>
    <tr>
      <th>9</th>
      <td>100</td>
      <td>3</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.8</td>
      <td>0.863153</td>
      <td>0.006912</td>
      <td>31</td>
    </tr>
    <tr>
      <th>10</th>
      <td>200</td>
      <td>3</td>
      <td>0.01</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.882794</td>
      <td>0.007908</td>
      <td>27</td>
    </tr>
    <tr>
      <th>11</th>
      <td>200</td>
      <td>3</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.8</td>
      <td>0.881148</td>
      <td>0.007408</td>
      <td>28</td>
    </tr>
    <tr>
      <th>12</th>
      <td>100</td>
      <td>6</td>
      <td>0.01</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.917572</td>
      <td>0.010600</td>
      <td>21</td>
    </tr>
    <tr>
      <th>13</th>
      <td>100</td>
      <td>6</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.8</td>
      <td>0.916349</td>
      <td>0.010581</td>
      <td>22</td>
    </tr>
    <tr>
      <th>14</th>
      <td>200</td>
      <td>6</td>
      <td>0.01</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.928296</td>
      <td>0.012469</td>
      <td>18</td>
    </tr>
    <tr>
      <th>15</th>
      <td>200</td>
      <td>6</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.8</td>
      <td>0.928376</td>
      <td>0.012804</td>
      <td>17</td>
    </tr>
    <tr>
      <th>16</th>
      <td>100</td>
      <td>3</td>
      <td>0.10</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0.930834</td>
      <td>0.011655</td>
      <td>13</td>
    </tr>
    <tr>
      <th>17</th>
      <td>100</td>
      <td>3</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.930193</td>
      <td>0.011633</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>200</td>
      <td>3</td>
      <td>0.10</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0.942380</td>
      <td>0.012564</td>
      <td>9</td>
    </tr>
    <tr>
      <th>19</th>
      <td>200</td>
      <td>3</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.941043</td>
      <td>0.012615</td>
      <td>12</td>
    </tr>
    <tr>
      <th>20</th>
      <td>100</td>
      <td>6</td>
      <td>0.10</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0.950395</td>
      <td>0.013361</td>
      <td>5</td>
    </tr>
    <tr>
      <th>21</th>
      <td>100</td>
      <td>6</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.949846</td>
      <td>0.012906</td>
      <td>8</td>
    </tr>
    <tr>
      <th>22</th>
      <td>200</td>
      <td>6</td>
      <td>0.10</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0.955882</td>
      <td>0.014179</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>200</td>
      <td>6</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.954727</td>
      <td>0.013775</td>
      <td>3</td>
    </tr>
    <tr>
      <th>24</th>
      <td>100</td>
      <td>3</td>
      <td>0.01</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0.865051</td>
      <td>0.007752</td>
      <td>30</td>
    </tr>
    <tr>
      <th>25</th>
      <td>100</td>
      <td>3</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.865805</td>
      <td>0.007026</td>
      <td>29</td>
    </tr>
    <tr>
      <th>26</th>
      <td>200</td>
      <td>3</td>
      <td>0.01</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0.885755</td>
      <td>0.009257</td>
      <td>25</td>
    </tr>
    <tr>
      <th>27</th>
      <td>200</td>
      <td>3</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.884829</td>
      <td>0.009119</td>
      <td>26</td>
    </tr>
    <tr>
      <th>28</th>
      <td>100</td>
      <td>6</td>
      <td>0.01</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0.913376</td>
      <td>0.011449</td>
      <td>23</td>
    </tr>
    <tr>
      <th>29</th>
      <td>100</td>
      <td>6</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.912450</td>
      <td>0.010810</td>
      <td>24</td>
    </tr>
    <tr>
      <th>30</th>
      <td>200</td>
      <td>6</td>
      <td>0.01</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0.926352</td>
      <td>0.012571</td>
      <td>19</td>
    </tr>
    <tr>
      <th>31</th>
      <td>200</td>
      <td>6</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.926078</td>
      <td>0.011876</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-587405ce-cf93-4781-b3a8-5b4a3486bb6a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-587405ce-cf93-4781-b3a8-5b4a3486bb6a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-587405ce-cf93-4781-b3a8-5b4a3486bb6a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4bc37839-4594-4fa8-856f-929d6ba0adab">
  <button class="colab-df-quickchart" onclick="quickchart('df-4bc37839-4594-4fa8-856f-929d6ba0adab')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4bc37839-4594-4fa8-856f-929d6ba0adab button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar el mejor modelo encontrado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejores Parámetros para XGBoost:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n_estimators: </span><span class="si">{</span><span class="n">best_params_xgb</span><span class="p">[</span><span class="s1">&#39;xgbclassifier__n_estimators&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_depth: </span><span class="si">{</span><span class="n">best_params_xgb</span><span class="p">[</span><span class="s1">&#39;xgbclassifier__max_depth&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;learning_rate: </span><span class="si">{</span><span class="n">best_params_xgb</span><span class="p">[</span><span class="s1">&#39;xgbclassifier__learning_rate&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;subsample: </span><span class="si">{</span><span class="n">best_params_xgb</span><span class="p">[</span><span class="s1">&#39;xgbclassifier__subsample&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;colsample_bytree: </span><span class="si">{</span><span class="n">best_params_xgb</span><span class="p">[</span><span class="s1">&#39;xgbclassifier__colsample_bytree&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precisión de Validación: </span><span class="si">{</span><span class="n">val_accuracy_xgb</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AUC Guardado en &#39;auc_xgb&#39;: </span><span class="si">{</span><span class="n">auc_xgb</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores Parámetros para XGBoost:
n_estimators: 200
max_depth: 6
learning_rate: 0.1
subsample: 0.8
colsample_bytree: 0.8
Precisión de Validación: 0.8914
AUC Guardado en &#39;auc_xgb&#39;: 0.8331
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Guardar el mejor modelo entrenado con joblib</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">best_model_xgb</span><span class="p">,</span> <span class="s1">&#39;best_xgboost_model.joblib&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">El mejor modelo de XGBoost ha sido guardado como &#39;best_xgboost_model.joblib&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El mejor modelo de XGBoost ha sido guardado como &#39;best_xgboost_model.joblib&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-suport-vector-machine-svm-con-balanceo-de-clases-smoteenn">
<h2>Modelo Suport Vector Machine (SVM) con balanceo de clases SMOTEENN<a class="headerlink" href="#modelo-suport-vector-machine-svm-con-balanceo-de-clases-smoteenn" title="Link to this heading">#</a></h2>
<p>El modelo SVM (Support Vector Machines) es una técnica de clasificación que busca encontrar el mejor hiperplano que separe dos clases maximizando la distancia entre ellas (margen):
Se realiza inicalmente un proceso de balanceo de clases con el método de undersampling de clase mayoritaria y oversampling de clase minoritaria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separar características y objetivo en el conjunto de entrenamiento</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>

<span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Dividir el conjunto de entrenamiento en entrenamiento y validación</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar SMOTEENN solo al conjunto de entrenamiento</span>
<span class="n">smoteenn</span> <span class="o">=</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled_svm</span><span class="p">,</span> <span class="n">y_resampled_svm</span> <span class="o">=</span> <span class="n">smoteenn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;svc__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>                    <span class="c1"># Parámetro de regularización</span>
    <span class="s1">&#39;svc__kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">],</span>         <span class="c1"># Tipo de kernel</span>
    <span class="s1">&#39;svc__gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">],</span>          <span class="c1"># Parámetro de kernel para &#39;rbf&#39;</span>
    <span class="s1">&#39;pca__n_components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]</span>         <span class="c1"># Variancia explicada por PCA</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;onehot&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Combinar los transformadores en un preprocesador</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">numerical_transformer</span><span class="p">,</span> <span class="n">numerical_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_svm_pca</span> <span class="o">=</span> <span class="n">ImbPipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="n">PCA</span><span class="p">()),</span>                             <span class="c1"># PCA para reducción de dimensionalidad</span>
    <span class="p">(</span><span class="s1">&#39;smoteenn&#39;</span><span class="p">,</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)),</span>    <span class="c1"># Balanceo de clases</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span>  <span class="c1"># Clasificador SVM lineal</span>
<span class="p">])</span>


<span class="n">param_dist_svm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pca__n_components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">],</span>  <span class="c1"># Varianza explicada por PCA</span>
    <span class="s1">&#39;classifier__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>              <span class="c1"># Parámetro de regularización</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configurar GridSearchCV para la búsqueda de hiperparámetros</span>
<span class="n">grid_search_svm</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_svm_pca</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>                      <span class="c1"># Número de pliegues en la validación cruzada</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>        <span class="c1"># Métrica a optimizar</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_filename</span> <span class="o">=</span> <span class="s2">&quot;best_svm_model_pca_optimized.pkl&quot;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">model_filename</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">El modelo ya existe. Cargando desde </span><span class="si">{</span><span class="n">model_filename</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">best_svm_model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_filename</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">El modelo no existe. Entrenando un nuevo modelo...&quot;</span><span class="p">)</span>

    <span class="c1"># Optimización de hiperparámetros con RandomizedSearchCV</span>
    <span class="n">randomized_search_svm</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span>
        <span class="n">pipeline_svm_pca</span><span class="p">,</span>
        <span class="n">param_distributions</span><span class="o">=</span><span class="n">param_dist_svm</span><span class="p">,</span>
        <span class="n">n_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>                     <span class="c1"># Número de iteraciones</span>
        <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>                         <span class="c1"># Número de pliegues en la validación cruzada</span>
        <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>           <span class="c1"># Métrica a optimizar</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>

    <span class="c1"># Entrenar el modelo con el conjunto de entrenamiento</span>
    <span class="n">randomized_search_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Obtener el mejor modelo</span>
    <span class="n">best_svm_model</span> <span class="o">=</span> <span class="n">randomized_search_svm</span><span class="o">.</span><span class="n">best_estimator_</span>
    <span class="n">best_params_svm</span> <span class="o">=</span> <span class="n">randomized_search_svm</span><span class="o">.</span><span class="n">best_params_</span>
    <span class="n">best_val_accuracy_svm</span> <span class="o">=</span> <span class="n">randomized_search_svm</span><span class="o">.</span><span class="n">best_score_</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejores parámetros seleccionados: </span><span class="si">{</span><span class="n">best_params_svm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor precisión de validación en cross-validation: </span><span class="si">{</span><span class="n">best_val_accuracy_svm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Guardar el mejor modelo</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">best_svm_model</span><span class="p">,</span> <span class="n">model_filename</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Modelo guardado como </span><span class="si">{</span><span class="n">model_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El modelo no existe. Entrenando un nuevo modelo...
Fitting 3 folds for each of 5 candidates, totalling 15 fits

Mejores parámetros seleccionados: {&#39;pca__n_components&#39;: 0.7, &#39;classifier__C&#39;: 0.1}
Mejor precisión de validación en cross-validation: 0.6738

Modelo guardado como best_svm_model_pca_optimized.pkl
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Realizar predicciones en el conjunto de validación</span>
<span class="n">y_val_pred_svm</span> <span class="o">=</span> <span class="n">best_svm_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>

<span class="c1"># Obtener scores para AUC utilizando decision_function</span>
<span class="n">y_val_scores</span> <span class="o">=</span> <span class="n">best_svm_model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">val_auc_svm</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_scores</span><span class="p">)</span>

<span class="c1"># Calcular métricas para el conjunto de validación</span>
<span class="n">val_precision_svm</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_svm</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">val_recall_svm</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_svm</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">val_accuracy_svm</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_svm</span><span class="p">)</span>
<span class="n">val_f1_svm</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_svm</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Métricas en el conjunto de validación:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">val_precision_svm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">val_recall_svm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">val_accuracy_svm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-Score: </span><span class="si">{</span><span class="n">val_f1_svm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AUC: </span><span class="si">{</span><span class="n">val_auc_svm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Métricas en el conjunto de validación:
Precision: 0.0849
Recall: 0.7375
Accuracy: 0.6750
F1-Score: 0.1523
AUC: 0.7814
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matriz de confusión</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_svm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matriz de confusión:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>

<span class="c1"># Crear la visualización con etiquetas y un formato más claro</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Insatisfecho&quot;</span><span class="p">,</span> <span class="s2">&quot;Satisfecho&quot;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Insatisfecho&quot;</span><span class="p">,</span> <span class="s2">&quot;Satisfecho&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de Confusión&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Predicciones&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Valores Reales&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1fed313bf4e93adc8233bbb5058a427ca58e014c318ab288c6fe810b9fc075b4.png" src="_images/1fed313bf4e93adc8233bbb5058a427ca58e014c318ab288c6fe810b9fc075b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_scores</span><span class="p">)</span>  <span class="c1"># Calcular FPR y TPR</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>  <span class="c1"># Calcular AUC</span>

<span class="c1"># Crear la gráfica ROC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Curva ROC (AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>  <span class="c1"># Línea de referencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Curva ROC - Modelo SVM&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dc1bd53b5d837b33202d33936d2c86bce548ed212c5d63b9527c09100f9f50c4.png" src="_images/dc1bd53b5d837b33202d33936d2c86bce548ed212c5d63b9527c09100f9f50c4.png" />
</div>
</div>
</section>
<section id="modelo-random-forest-con-balanceo-de-clases-smoteenn">
<h2>Modelo Random Forest con balanceo de clases SMOTEENN<a class="headerlink" href="#modelo-random-forest-con-balanceo-de-clases-smoteenn" title="Link to this heading">#</a></h2>
<p>Para el modleo de RF se dividen los datos y se balancean las clases dld conjunto d entrenamieto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separar características y objetivo en el conjunto de entrenamiento</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>

<span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Dividir el conjunto de entrenamiento en entrenamiento y validación</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="c1"># Aplicar SMOTEENN solo al conjunto de entrenamiento</span>
<span class="n">smoteenn</span> <span class="o">=</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled_rf</span><span class="p">,</span> <span class="n">y_resampled_rf</span> <span class="o">=</span> <span class="n">smoteenn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>  <span class="c1"># Escalado de características numéricas</span>
<span class="p">])</span>

<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;onehot&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>  <span class="c1"># Codificación one-hot</span>
<span class="p">])</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">numerical_transformer</span><span class="p">,</span> <span class="n">numerical_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># **Crear el Pipeline con preprocesamiento y Random Forest**</span>
<span class="n">pipe_rf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>  <span class="c1"># Preprocesador compuesto</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>  <span class="c1"># Clasificador Random Forest</span>
<span class="p">])</span>

<span class="c1"># **Definir el espacio de hiperparámetros optimizado**</span>
<span class="n">param_grid_rf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>  <span class="c1"># Número de árboles</span>
    <span class="s1">&#39;classifier__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>  <span class="c1"># Profundidad máxima</span>
    <span class="s1">&#39;classifier__min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># Mínimo de muestras para dividir</span>
    <span class="s1">&#39;classifier__min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>  <span class="c1"># Mínimo de muestras en hojas</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Evaluacion de mejores hiperparametros del modelo.</strong></p>
<p>Los mejores hiperparámetros encontrados son: max_depth=None (sin límite de profundidad), min_samples_leaf=1 (mínimo de una muestra por hoja), min_samples_split=2 (mínimo de dos muestras para dividir un nodo) y n_estimators=200 (200 árboles).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_filename</span> <span class="o">=</span> <span class="s2">&quot;best_rf_model.pkl&quot;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">model_filename</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El modelo ya existe. Cargando desde </span><span class="si">{</span><span class="n">model_filename</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">best_rf_model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_filename</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El modelo no existe. Entrenando un nuevo modelo...&quot;</span><span class="p">)</span>
    <span class="c1"># Crear el GridSearchCV con validación cruzada</span>
    <span class="n">grid_rf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_rf</span><span class="p">,</span> <span class="n">param_grid_rf</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">grid_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled_rf</span><span class="p">,</span> <span class="n">y_resampled_rf</span><span class="p">)</span>  <span class="c1"># Usar datos balanceados de entrenamiento</span>

    <span class="c1"># Guardar el mejor modelo</span>
    <span class="n">best_rf_model</span> <span class="o">=</span> <span class="n">grid_rf</span><span class="o">.</span><span class="n">best_estimator_</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">best_rf_model</span><span class="p">,</span> <span class="n">model_filename</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modelo guardado como </span><span class="si">{</span><span class="n">model_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Resultados del modelo</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores hiperparámetros encontrados:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">grid_rf</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejor puntuación de validación (AUC): </span><span class="si">{</span><span class="n">grid_rf</span><span class="o">.</span><span class="n">best_score_</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El modelo no existe. Entrenando un nuevo modelo...
Fitting 5 folds for each of 81 candidates, totalling 405 fits
Modelo guardado como best_rf_model.pkl
Mejores hiperparámetros encontrados:
{&#39;classifier__max_depth&#39;: None, &#39;classifier__min_samples_leaf&#39;: 1, &#39;classifier__min_samples_split&#39;: 2, &#39;classifier__n_estimators&#39;: 200}

Mejor puntuación de validación (AUC): 0.993898
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Realizar predicciones en el conjunto de validación</span>
<span class="n">y_val_pred_rf</span> <span class="o">=</span> <span class="n">best_rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">y_val_proba_rf</span> <span class="o">=</span> <span class="n">best_rf_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calcular métricas para el conjunto de validación</span>
<span class="n">val_precision_rf</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_rf</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">val_recall_rf</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_rf</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">val_accuracy_rf</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_rf</span><span class="p">)</span>
<span class="n">val_f1_rf</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_rf</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">val_auc_rf</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_proba_rf</span><span class="p">)</span>

<span class="c1"># Imprimir las métricas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Métricas de Evaluación en el Conjunto de Validación:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precisión: </span><span class="si">{</span><span class="n">val_precision_rf</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">val_recall_rf</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">val_accuracy_rf</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-Score: </span><span class="si">{</span><span class="n">val_f1_rf</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AUC: </span><span class="si">{</span><span class="n">val_auc_rf</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Métricas de Evaluación en el Conjunto de Validación:
Precisión: 0.1804
Recall: 0.3887
Accuracy: 0.9059
F1-Score: 0.2464
AUC: 0.8002
</pre></div>
</div>
</div>
</div>
<p>El modelo Random Forest tiene un desempeño sobresaliente con AUC &gt; 0.970 en todas las configuraciones. La mejor combinación es con un número elevado de árboles (n_estimators=200) y una profundidad máxima mayor, lo que logra capturar mejor las relaciones sin comprometer la generalización. Sin embargo, profundidades mayores a 20 parecen no aportar mejoras significativas adicionales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results_rf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grid_rf</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">scatter</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">results_rf</span><span class="p">[</span><span class="s1">&#39;param_classifier__max_depth&#39;</span><span class="p">],</span>
    <span class="n">results_rf</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="n">results_rf</span><span class="p">[</span><span class="s1">&#39;param_classifier__n_estimators&#39;</span><span class="p">],</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scatter</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Número de Árboles (n_estimators)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Profundidad Máxima del Árbol (max_depth)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precisión Media CV (ROC AUC)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Precisión Media CV vs. Profundidad Máxima del Árbol para diferentes Valores de n_estimators en Random Forest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b3da24be82937f7c0ef1d400581c82d8334d00dacd620aedd3ede6ca04670afd.png" src="_images/b3da24be82937f7c0ef1d400581c82d8334d00dacd620aedd3ede6ca04670afd.png" />
</div>
</div>
<p>Àrea bajo la curva</p>
<ul class="simple">
<li><p>AUC = 0.8002 (80.02%)
La curva se eleva rápidamente en las primeras etapas, indicando que el modelo mantiene una buena Tasa de Verdaderos Positivos (TPR) incluso con bajos Falsos Positivos (FPR).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generar curva ROC para el conjunto de validación</span>
<span class="n">fpr_rf</span><span class="p">,</span> <span class="n">tpr_rf</span><span class="p">,</span> <span class="n">thresholds_rf</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_proba_rf</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_rf</span><span class="p">,</span> <span class="n">tpr_rf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC Validación (AUC = </span><span class="si">{</span><span class="n">val_auc_rf</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>  <span class="c1"># Línea de referencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos (FPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos (TPR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC para el Modelo Random Forest con PCA Optimizado&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eecfc51dba6b19235a14a377a0ea760d809be13c107ad5cafbc1cd6efbc09d86.png" src="_images/eecfc51dba6b19235a14a377a0ea760d809be13c107ad5cafbc1cd6efbc09d86.png" />
</div>
</div>
<p>Matriz de confusión</p>
<ul class="simple">
<li><p>Verdaderos Negativos (TN): 13,539</p></li>
<li><p>Falsos Negativos (FN): 368</p></li>
<li><p>Falsos Positivos (FP): 1,063</p></li>
<li><p>Verdaderos Positivos (TP): 234</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generar matriz de confusión para el conjunto de validación</span>
<span class="n">cm_rf</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_rf</span><span class="p">)</span>
<span class="n">disp_rf</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="o">=</span><span class="n">cm_rf</span><span class="p">,</span> <span class="n">display_labels</span><span class="o">=</span><span class="n">best_rf_model</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;classifier&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
<span class="n">disp_rf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión - Validación (Random Forest con PCA Optimizado)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5c41f93bd23a924dceb09ac1b22961261ca32d759186c39d3255af2f28cbff5.png" src="_images/f5c41f93bd23a924dceb09ac1b22961261ca32d759186c39d3255af2f28cbff5.png" />
</div>
</div>
<p><strong>Feature importance</strong></p>
<p>Representa los 15 componentes principales seleccionados, denominados PC# (donde # es el índice del componente).
Estos componentes son combinaciones lineales de las variables originales que explican la mayor parte de la varianza en los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extraer las importancias de las características del modelo</span>
<span class="n">importances_rf</span> <span class="o">=</span> <span class="n">best_rf_model</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;classifier&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">feature_importances_</span>

<span class="c1"># Obtener los nombres de los componentes principales</span>
<span class="n">pca_components</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PC</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">importances_rf</span><span class="p">))]</span>

<span class="c1"># Crear un DataFrame para visualizar las importancias</span>
<span class="n">feature_importances_rf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Componente Principal&#39;</span><span class="p">:</span> <span class="n">pca_components</span><span class="p">,</span>
    <span class="s1">&#39;Importancia&#39;</span><span class="p">:</span> <span class="n">importances_rf</span>
<span class="p">})</span>

<span class="c1"># Ordenar el DataFrame por importancia en orden ascendente</span>
<span class="n">feature_importances_rf</span> <span class="o">=</span> <span class="n">feature_importances_rf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Importancia&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Seleccionar únicamente las 15 características más importantes</span>
<span class="n">feature_importances_rf_top15</span> <span class="o">=</span> <span class="n">feature_importances_rf</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Resetear el índice para una mejor visualización</span>
<span class="n">feature_importances_rf_top15</span> <span class="o">=</span> <span class="n">feature_importances_rf_top15</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plotear las importancias de las 15 características más importantes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span>
    <span class="n">feature_importances_rf_top15</span><span class="p">[</span><span class="s1">&#39;Componente Principal&#39;</span><span class="p">],</span>
    <span class="n">feature_importances_rf_top15</span><span class="p">[</span><span class="s1">&#39;Importancia&#39;</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Importancia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Importancia de las 15 Características Principales (Componentes Principales)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c5ef19eb1df7847b82b6f6c8fbe7d0adabeea2a7c176a642348a419e6d602219.png" src="_images/c5ef19eb1df7847b82b6f6c8fbe7d0adabeea2a7c176a642348a419e6d602219.png" />
</div>
</div>
</section>
<section id="metricas-finales-para-cada-modelo">
<h2>Mètricas finales para cada modelo<a class="headerlink" href="#metricas-finales-para-cada-modelo" title="Link to this heading">#</a></h2>
<p>La tabla muestra las métricas de varios modelos en términos de precisión, recall, accuracy, F1-Score y AUC.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar el DataFrame actualizado</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Métricas de los modelos:&quot;</span><span class="p">)</span>
<span class="n">df_metricss</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Métricas de los modelos:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-3731995a-e9f3-4a2f-bb96-6e0052331bda" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>Accuracy</th>
      <th>F1-Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bayesiano</td>
      <td>0.043700</td>
      <td>0.965100</td>
      <td>0.843000</td>
      <td>0.082000</td>
      <td>0.542500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K-NN</td>
      <td>0.341294</td>
      <td>0.694929</td>
      <td>0.877022</td>
      <td>0.319162</td>
      <td>0.706300</td>
    </tr>
    <tr>
      <th>2</th>
      <td>L1/L2 Penalty Logistic Regression</td>
      <td>0.840900</td>
      <td>0.879900</td>
      <td>0.850800</td>
      <td>0.860000</td>
      <td>0.845739</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Random Forest</td>
      <td>0.841000</td>
      <td>0.880000</td>
      <td>0.873000</td>
      <td>0.860000</td>
      <td>0.993900</td>
    </tr>
    <tr>
      <th>4</th>
      <td>XGBoost</td>
      <td>0.180500</td>
      <td>0.500000</td>
      <td>0.873000</td>
      <td>0.243100</td>
      <td>0.833100</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SVM</td>
      <td>0.084900</td>
      <td>0.737500</td>
      <td>0.675000</td>
      <td>0.152300</td>
      <td>0.781400</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3731995a-e9f3-4a2f-bb96-6e0052331bda')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3731995a-e9f3-4a2f-bb96-6e0052331bda button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3731995a-e9f3-4a2f-bb96-6e0052331bda');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-18b23fce-c36d-44cc-8f9c-5929c879bbb3">
  <button class="colab-df-quickchart" onclick="quickchart('df-18b23fce-c36d-44cc-8f9c-5929c879bbb3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-18b23fce-c36d-44cc-8f9c-5929c879bbb3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<p><strong>Conclusiones generales</strong></p>
<p><em>Análisis por modelo:</em></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Bayesiano</span></code>:</p></li>
</ol>
<ul class="simple">
<li><p>Tiene el recall más alto (0.9651), lo que significa que detecta casi todos los casos positivos correctamente.</p></li>
<li><p>Sin embargo, su precisión (0.0437) es extremadamente baja, lo que indica una alta cantidad de falsos positivos.</p></li>
<li><p>El F1-Score (0.0820) es bajo, mostrando un desequilibrio entre precisión y recall.</p></li>
<li><p>Conclusión: Este modelo podría ser útil si el objetivo es minimizar falsos negativos (priorizando el recall), pero no es confiable para predicciones precisas.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">K-NN:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Presenta un balance moderado entre todas las métricas.</p></li>
<li><p>Tiene un recall aceptable (0.6949) y una precisión baja (0.3413), resultando en un F1-Score bajo (0.3192).</p></li>
<li><p>Su AUC (0.7063) indica que separa las clases mejor que un modelo aleatorio.</p></li>
<li><p>Conclusión: Este modelo no es ideal para aplicaciones críticas, pero puede ser considerado si se prefiere simplicidad en el entrenamiento.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><code class="docutils literal notranslate"><span class="pre">L1/L2</span> <span class="pre">Penalty</span> <span class="pre">Logistic</span> <span class="pre">Regression:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Tiene un desempeño consistente y equilibrado en todas las métricas, con un - F1-Score alto (0.8600) y una AUC (0.8457) decente.</p></li>
<li><p>Su precisión (0.8409) y recall (0.8799) son altos, lo que lo hace confiable tanto para minimizar falsos positivos como falsos negativos.</p></li>
<li><p>Conclusión: Este modelo es robusto y versátil, adecuado para la mayoría de - - los problemas donde se requiere un balance entre precisión y recall.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">Random</span> <span class="pre">Forest:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Es el mejor modelo en términos de AUC (0.9939), lo que significa que es excelente para distinguir entre clases.</p></li>
<li><p>Su F1-Score (0.8600) es igual al de Logistic Regression, pero con una ligera ventaja en precisión y recall.</p></li>
<li><p>Conclusión: Random Forest es el modelo más sólido en general, especialmente si el objetivo es maximizar la separación entre clases.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p><code class="docutils literal notranslate"><span class="pre">XGBoost:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Tiene una precisión (0.1805) y recall (0.5000) relativamente bajos, lo que afecta negativamente su F1-Score (0.2431).</p></li>
<li><p>Sin embargo, su AUC (0.8331) muestra que puede realizar una buena separación entre clases en términos relativos.</p></li>
<li><p>Conclusión: Este modelo no es el mejor en esta comparación, pero podría mejorarse con optimización de hiperparámetros.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Punto1EDA_Parcial3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Problema de clasificación</p>
      </div>
    </a>
    <a class="right-next"
       href="segundo_punto.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ejercicios de Fisioterapia: EDA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Modelamiento del Conjunto de Datos: Satisfacción de Clientes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-de-modelos-de-clasificacion">1. Implementación de Modelos de Clasificación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cargue-e-instalacion-de-librerias">Cargue e instalación de librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cargue-de-datos">Cargue de datos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtrado-de-variables-a-modelar">Filtrado de variables a modelar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conjunto-de-entrenamiento">Conjunto de entrenamiento</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#conjunto-de-test">Conjunto de test</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-machine-learning">Modelos de Machine Learning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-la-variable-objetivo">Análisis exploratorio de la variable objetivo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combinacion-oversampling-de-la-clase-minoritaria-y-undersampling-de-la-clase-mayoritaria-smoteenn"><strong>Combinación Oversampling de la Clase Minoritaria y Undersampling de la clase mayoritaria (SMOTEENN)</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-clasificacion-bayesiana-con-balanceo-de-clases-smoteenn">Modelo de Clasificación Bayesiana con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-l1-l2-penalty-logistic-regression-con-balanceo-de-clases-smoteenn">Modelo L1/L2 Penalty Logistic Regression con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-clasificacion-k-nn-con-balanceo-de-clases-smoteenn">Modelo de clasificación K-NN con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-con-balanceo-de-clase-smoteenn">XGBoost con balanceo de clase SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-suport-vector-machine-svm-con-balanceo-de-clases-smoteenn">Modelo Suport Vector Machine (SVM) con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-random-forest-con-balanceo-de-clases-smoteenn">Modelo Random Forest con balanceo de clases SMOTEENN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-finales-para-cada-modelo">Mètricas finales para cada modelo</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Henry Saenz y Kelly Beltran
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>